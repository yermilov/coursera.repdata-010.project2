<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>The Most Harmful Weather Events Across the United States</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>The Most Harmful Weather Events Across the United States</h1>

<h2>Synopsis</h2>

<p>Storms and other severe weather events can cause both public health and economic problems for communities and municipalities. Many severe events can result in fatalities, injuries, and property damage, and preventing such outcomes to the extent possible is a key concern.
The basic goal of this investigation is to explore the NOAA Storm Database and answer some basic questions about severe weather events:</p>

<ul>
<li>Across the United States, which types of events are most harmful with respect to population health?</li>
<li>Across the United States, which types of events have the greatest economic consequences?</li>
</ul>

<p>We will take the U.S. National Oceanic and Atmospheric Administration&#39;s (NOAA) storm database for investigations. Additional preprocessing is performed as it&#39;s needed before resulting processing.
Result shows that tornado and flood produces the biggest damage of all types. Tornado, excessive heat, thunderstorm wind and lighting cause the biggest population damage. Flood, hurricane, tornado and storm surge cause the biggest economical damage. Some interesting issues are investigated additionally.</p>

<h2>Data Processing</h2>

<h3>Data set</h3>

<p>The U.S. National Oceanic and Atmospheric Administration&#39;s (NOAA) storm database is used for investigation. This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage. The data is downloaded in the form of a comma-separated-value file compressed via the bzip2 algorithm from <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2">source</a>.
There is also some documentation of the database available:</p>

<ul>
<li><a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf">National Weather Service Storm Data Documentation</a></li>
<li><a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2FNCDC%20Storm%20Events-FAQ%20Page.pdf">National Climatic Data Center Storm Events FAQ</a>
The events in the database start in the year 1950 and end in November 2011. In the earlier years of the database there are generally fewer events recorded, most likely due to a lack of good records. More recent years should be considered more complete.</li>
</ul>

<h3>Data download</h3>

<p>As mentioned before, data is downloaded from <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2">source</a> and placed in &#39;data/&#39; directory. &#39;dplyr&#39; package is used immediatelly for data processing.</p>

<pre><code class="r">if (!file.exists(&quot;data&quot;)) {
    dir.create(&quot;data&quot;)
}
download.file(&quot;https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2&quot;, dest = &quot;data/storm_data.csv.bz2&quot;)

library(dplyr)
data &lt;- tbl_df(read.csv(&quot;data/storm_data.csv.bz2&quot;))
</code></pre>

<p>Let&#39;s verify data that was downloaded:</p>

<pre><code class="r">data
</code></pre>

<pre><code>## Source: local data frame [902,297 x 37]
## 
##    STATE__           BGN_DATE BGN_TIME TIME_ZONE COUNTY COUNTYNAME STATE
## 1        1  4/18/1950 0:00:00     0130       CST     97     MOBILE    AL
## 2        1  4/18/1950 0:00:00     0145       CST      3    BALDWIN    AL
## 3        1  2/20/1951 0:00:00     1600       CST     57    FAYETTE    AL
## 4        1   6/8/1951 0:00:00     0900       CST     89    MADISON    AL
## 5        1 11/15/1951 0:00:00     1500       CST     43    CULLMAN    AL
## 6        1 11/15/1951 0:00:00     2000       CST     77 LAUDERDALE    AL
## 7        1 11/16/1951 0:00:00     0100       CST      9     BLOUNT    AL
## 8        1  1/22/1952 0:00:00     0900       CST    123 TALLAPOOSA    AL
## 9        1  2/13/1952 0:00:00     2000       CST    125 TUSCALOOSA    AL
## 10       1  2/13/1952 0:00:00     2000       CST     57    FAYETTE    AL
## ..     ...                ...      ...       ...    ...        ...   ...
## Variables not shown: EVTYPE (fctr), BGN_RANGE (dbl), BGN_AZI (fctr),
##   BGN_LOCATI (fctr), END_DATE (fctr), END_TIME (fctr), COUNTY_END (dbl),
##   COUNTYENDN (lgl), END_RANGE (dbl), END_AZI (fctr), END_LOCATI (fctr),
##   LENGTH (dbl), WIDTH (dbl), F (int), MAG (dbl), FATALITIES (dbl),
##   INJURIES (dbl), PROPDMG (dbl), PROPDMGEXP (fctr), CROPDMG (dbl),
##   CROPDMGEXP (fctr), WFO (fctr), STATEOFFIC (fctr), ZONENAMES (fctr),
##   LATITUDE (dbl), LONGITUDE (dbl), LATITUDE_E (dbl), LONGITUDE_ (dbl),
##   REMARKS (fctr), REFNUM (dbl)
</code></pre>

<pre><code class="r">summary(data)
</code></pre>

<pre><code>##     STATE__                  BGN_DATE             BGN_TIME     
##  Min.   : 1.0   5/25/2011 0:00:00:  1202   12:00:00 AM: 10163  
##  1st Qu.:19.0   4/27/2011 0:00:00:  1193   06:00:00 PM:  7350  
##  Median :30.0   6/9/2011 0:00:00 :  1030   04:00:00 PM:  7261  
##  Mean   :31.2   5/30/2004 0:00:00:  1016   05:00:00 PM:  6891  
##  3rd Qu.:45.0   4/4/2011 0:00:00 :  1009   12:00:00 PM:  6703  
##  Max.   :95.0   4/2/2006 0:00:00 :   981   03:00:00 PM:  6700  
##                 (Other)          :895866   (Other)    :857229  
##    TIME_ZONE          COUNTY           COUNTYNAME         STATE       
##  CST    :547493   Min.   :  0.0   JEFFERSON :  7840   TX     : 83728  
##  EST    :245558   1st Qu.: 31.0   WASHINGTON:  7603   KS     : 53440  
##  MST    : 68390   Median : 75.0   JACKSON   :  6660   OK     : 46802  
##  PST    : 28302   Mean   :100.6   FRANKLIN  :  6256   MO     : 35648  
##  AST    :  6360   3rd Qu.:131.0   LINCOLN   :  5937   IA     : 31069  
##  HST    :  2563   Max.   :873.0   MADISON   :  5632   NE     : 30271  
##  (Other):  3631                   (Other)   :862369   (Other):621339  
##                EVTYPE         BGN_RANGE           BGN_AZI      
##  HAIL             :288661   Min.   :   0.000          :547332  
##  TSTM WIND        :219940   1st Qu.:   0.000   N      : 86752  
##  THUNDERSTORM WIND: 82563   Median :   0.000   W      : 38446  
##  TORNADO          : 60652   Mean   :   1.484   S      : 37558  
##  FLASH FLOOD      : 54277   3rd Qu.:   1.000   E      : 33178  
##  FLOOD            : 25326   Max.   :3749.000   NW     : 24041  
##  (Other)          :170878                      (Other):134990  
##          BGN_LOCATI                  END_DATE             END_TIME     
##               :287743                    :243411              :238978  
##  COUNTYWIDE   : 19680   4/27/2011 0:00:00:  1214   06:00:00 PM:  9802  
##  Countywide   :   993   5/25/2011 0:00:00:  1196   05:00:00 PM:  8314  
##  SPRINGFIELD  :   843   6/9/2011 0:00:00 :  1021   04:00:00 PM:  8104  
##  SOUTH PORTION:   810   4/4/2011 0:00:00 :  1007   12:00:00 PM:  7483  
##  NORTH PORTION:   784   5/30/2004 0:00:00:   998   11:59:00 PM:  7184  
##  (Other)      :591444   (Other)          :653450   (Other)    :622432  
##    COUNTY_END COUNTYENDN       END_RANGE           END_AZI      
##  Min.   :0    Mode:logical   Min.   :  0.0000          :724837  
##  1st Qu.:0    NA&#39;s:902297    1st Qu.:  0.0000   N      : 28082  
##  Median :0                   Median :  0.0000   S      : 22510  
##  Mean   :0                   Mean   :  0.9862   W      : 20119  
##  3rd Qu.:0                   3rd Qu.:  0.0000   E      : 20047  
##  Max.   :0                   Max.   :925.0000   NE     : 14606  
##                                                 (Other): 72096  
##            END_LOCATI         LENGTH              WIDTH         
##                 :499225   Min.   :   0.0000   Min.   :   0.000  
##  COUNTYWIDE     : 19731   1st Qu.:   0.0000   1st Qu.:   0.000  
##  SOUTH PORTION  :   833   Median :   0.0000   Median :   0.000  
##  NORTH PORTION  :   780   Mean   :   0.2301   Mean   :   7.503  
##  CENTRAL PORTION:   617   3rd Qu.:   0.0000   3rd Qu.:   0.000  
##  SPRINGFIELD    :   575   Max.   :2315.0000   Max.   :4400.000  
##  (Other)        :380536                                         
##        F               MAG            FATALITIES          INJURIES        
##  Min.   :0.0      Min.   :    0.0   Min.   :  0.0000   Min.   :   0.0000  
##  1st Qu.:0.0      1st Qu.:    0.0   1st Qu.:  0.0000   1st Qu.:   0.0000  
##  Median :1.0      Median :   50.0   Median :  0.0000   Median :   0.0000  
##  Mean   :0.9      Mean   :   46.9   Mean   :  0.0168   Mean   :   0.1557  
##  3rd Qu.:1.0      3rd Qu.:   75.0   3rd Qu.:  0.0000   3rd Qu.:   0.0000  
##  Max.   :5.0      Max.   :22000.0   Max.   :583.0000   Max.   :1700.0000  
##  NA&#39;s   :843563                                                           
##     PROPDMG          PROPDMGEXP        CROPDMG          CROPDMGEXP    
##  Min.   :   0.00          :465934   Min.   :  0.000          :618413  
##  1st Qu.:   0.00   K      :424665   1st Qu.:  0.000   K      :281832  
##  Median :   0.00   M      : 11330   Median :  0.000   M      :  1994  
##  Mean   :  12.06   0      :   216   Mean   :  1.527   k      :    21  
##  3rd Qu.:   0.50   B      :    40   3rd Qu.:  0.000   0      :    19  
##  Max.   :5000.00   5      :    28   Max.   :990.000   B      :     9  
##                    (Other):    84                     (Other):     9  
##       WFO                                       STATEOFFIC    
##         :142069                                      :248769  
##  OUN    : 17393   TEXAS, North                       : 12193  
##  JAN    : 13889   ARKANSAS, Central and North Central: 11738  
##  LWX    : 13174   IOWA, Central                      : 11345  
##  PHI    : 12551   KANSAS, Southwest                  : 11212  
##  TSA    : 12483   GEORGIA, North and Central         : 11120  
##  (Other):690738   (Other)                            :595920  
##                                                                                                                                                                                                     ZONENAMES     
##                                                                                                                                                                                                          :594029  
##                                                                                                                                                                                                          :205988  
##  GREATER RENO / CARSON CITY / M - GREATER RENO / CARSON CITY / M                                                                                                                                         :   639  
##  GREATER LAKE TAHOE AREA - GREATER LAKE TAHOE AREA                                                                                                                                                       :   592  
##  JEFFERSON - JEFFERSON                                                                                                                                                                                   :   303  
##  MADISON - MADISON                                                                                                                                                                                       :   302  
##  (Other)                                                                                                                                                                                                 :100444  
##     LATITUDE      LONGITUDE        LATITUDE_E     LONGITUDE_    
##  Min.   :   0   Min.   :-14451   Min.   :   0   Min.   :-14455  
##  1st Qu.:2802   1st Qu.:  7247   1st Qu.:   0   1st Qu.:     0  
##  Median :3540   Median :  8707   Median :   0   Median :     0  
##  Mean   :2875   Mean   :  6940   Mean   :1452   Mean   :  3509  
##  3rd Qu.:4019   3rd Qu.:  9605   3rd Qu.:3549   3rd Qu.:  8735  
##  Max.   :9706   Max.   : 17124   Max.   :9706   Max.   :106220  
##  NA&#39;s   :47                      NA&#39;s   :40                     
##                                            REMARKS           REFNUM      
##                                                :287433   Min.   :     1  
##                                                : 24013   1st Qu.:225575  
##  Trees down.\n                                 :  1110   Median :451149  
##  Several trees were blown down.\n              :   568   Mean   :451149  
##  Trees were downed.\n                          :   446   3rd Qu.:676723  
##  Large trees and power lines were blown down.\n:   432   Max.   :902297  
##  (Other)                                       :588295
</code></pre>

<h3>Data preprocessing</h3>

<p>Mostly, we are interested in event types, population and economical damage that was caused by them. Following columns contain raw observations that we are interested in:</p>

<ul>
<li>EVTYPE - event type</li>
<li>FATALITIES, INJURIES - population damage</li>
<li>PROPDMG, PROPDMGEXP - property damage</li>
<li>CROPDMG, CROPDMGEXP - crop damage</li>
</ul>

<p>The data they contain is not ready for processing, so we need to prepare it, one by one.</p>

<h4>EVTYPE</h4>

<p>Let&#39;s exam EVTYPE column:</p>

<pre><code class="r">unique(data$EVTYPE)
</code></pre>

<pre><code>##   [1] TORNADO                        TSTM WIND                     
##   [3] HAIL                           FREEZING RAIN                 
##   [5] SNOW                           ICE STORM/FLASH FLOOD         
##   [7] SNOW/ICE                       WINTER STORM                  
##   [9] HURRICANE OPAL/HIGH WINDS      THUNDERSTORM WINDS            
##  [11] RECORD COLD                    HURRICANE ERIN                
##  [13] HURRICANE OPAL                 HEAVY RAIN                    
##  [15] LIGHTNING                      THUNDERSTORM WIND             
##  [17] DENSE FOG                      RIP CURRENT                   
##  [19] THUNDERSTORM WINS              FLASH FLOOD                   
##  [21] FLASH FLOODING                 HIGH WINDS                    
##  [23] FUNNEL CLOUD                   TORNADO F0                    
##  [25] THUNDERSTORM WINDS LIGHTNING   THUNDERSTORM WINDS/HAIL       
##  [27] HEAT                           WIND                          
##  [29] LIGHTING                       HEAVY RAINS                   
##  [31] LIGHTNING AND HEAVY RAIN       FUNNEL                        
##  [33] WALL CLOUD                     FLOODING                      
##  [35] THUNDERSTORM WINDS HAIL        FLOOD                         
##  [37] COLD                           HEAVY RAIN/LIGHTNING          
##  [39] FLASH FLOODING/THUNDERSTORM WI WALL CLOUD/FUNNEL CLOUD       
##  [41] THUNDERSTORM                   WATERSPOUT                    
##  [43] EXTREME COLD                   HAIL 1.75)                    
##  [45] LIGHTNING/HEAVY RAIN           HIGH WIND                     
##  [47] BLIZZARD                       BLIZZARD WEATHER              
##  [49] WIND CHILL                     BREAKUP FLOODING              
##  [51] HIGH WIND/BLIZZARD             RIVER FLOOD                   
##  [53] HEAVY SNOW                     FREEZE                        
##  [55] COASTAL FLOOD                  HIGH WIND AND HIGH TIDES      
##  [57] HIGH WIND/BLIZZARD/FREEZING RA HIGH TIDES                    
##  [59] HIGH WIND AND HEAVY SNOW       RECORD COLD AND HIGH WIND     
##  [61] RECORD HIGH TEMPERATURE        RECORD HIGH                   
##  [63] HIGH WINDS HEAVY RAINS         HIGH WIND/ BLIZZARD           
##  [65] ICE STORM                      BLIZZARD/HIGH WIND            
##  [67] HIGH WIND/LOW WIND CHILL       HEAVY SNOW/HIGH               
##  [69] RECORD LOW                     HIGH WINDS AND WIND CHILL     
##  [71] HEAVY SNOW/HIGH WINDS/FREEZING LOW TEMPERATURE RECORD        
##  [73] AVALANCHE                      MARINE MISHAP                 
##  [75] WIND CHILL/HIGH WIND           HIGH WIND/WIND CHILL/BLIZZARD 
##  [77] HIGH WIND/WIND CHILL           HIGH WIND/HEAVY SNOW          
##  [79] HIGH TEMPERATURE RECORD        FLOOD WATCH/                  
##  [81] RECORD HIGH TEMPERATURES       HIGH WIND/SEAS                
##  [83] HIGH WINDS/HEAVY RAIN          HIGH SEAS                     
##  [85] SEVERE TURBULENCE              RECORD RAINFALL               
##  [87] RECORD SNOWFALL                RECORD WARMTH                 
##  [89] HEAVY SNOW/WIND                EXTREME HEAT                  
##  [91] WIND DAMAGE                    DUST STORM                    
##  [93] APACHE COUNTY                  SLEET                         
##  [95] HAIL STORM                     FUNNEL CLOUDS                 
##  [97] FLASH FLOODS                   DUST DEVIL                    
##  [99] EXCESSIVE HEAT                 THUNDERSTORM WINDS/FUNNEL CLOU
## [101] WINTER STORM/HIGH WIND         WINTER STORM/HIGH WINDS       
## [103] GUSTY WINDS                    STRONG WINDS                  
## [105] FLOODING/HEAVY RAIN            SNOW AND WIND                 
## [107] HEAVY SURF COASTAL FLOODING    HEAVY SURF                    
## [109] HEAVY PRECIPATATION            URBAN FLOODING                
## [111] HIGH SURF                      BLOWING DUST                  
## [113] URBAN/SMALL                    WILD FIRES                    
## [115] HIGH                           URBAN/SMALL FLOODING          
## [117] WATER SPOUT                    HIGH WINDS DUST STORM         
## [119] WINTER STORM HIGH WINDS        LOCAL FLOOD                   
## [121] WINTER STORMS                  MUDSLIDES                     
## [123] RAINSTORM                      SEVERE THUNDERSTORM           
## [125] SEVERE THUNDERSTORMS           SEVERE THUNDERSTORM WINDS     
## [127] THUNDERSTORMS WINDS            DRY MICROBURST                
## [129] FLOOD/FLASH FLOOD              FLOOD/RAIN/WINDS              
## [131] WINDS                          DRY MICROBURST 61             
## [133] THUNDERSTORMS                  FLASH FLOOD WINDS             
## [135] URBAN/SMALL STREAM FLOODING    MICROBURST                    
## [137] STRONG WIND                    HIGH WIND DAMAGE              
## [139] STREAM FLOODING                URBAN AND SMALL               
## [141] HEAVY SNOWPACK                 ICE                           
## [143] FLASH FLOOD/                   DOWNBURST                     
## [145] GUSTNADO AND                   FLOOD/RAIN/WIND               
## [147] WET MICROBURST                 DOWNBURST WINDS               
## [149] DRY MICROBURST WINDS           DRY MIRCOBURST WINDS          
## [151] DRY MICROBURST 53              SMALL STREAM URBAN FLOOD      
## [153] MICROBURST WINDS               HIGH WINDS 57                 
## [155] DRY MICROBURST 50              HIGH WINDS 66                 
## [157] HIGH WINDS 76                  HIGH WINDS 63                 
## [159] HIGH WINDS 67                  BLIZZARD/HEAVY SNOW           
## [161] HEAVY SNOW/HIGH WINDS          BLOWING SNOW                  
## [163] HIGH WINDS 82                  HIGH WINDS 80                 
## [165] HIGH WINDS 58                  FREEZING DRIZZLE              
## [167] LIGHTNING THUNDERSTORM WINDSS  DRY MICROBURST 58             
## [169] HAIL 75                        HIGH WINDS 73                 
## [171] HIGH WINDS 55                  LIGHT SNOW AND SLEET          
## [173] URBAN FLOOD                    DRY MICROBURST 84             
## [175] THUNDERSTORM WINDS 60          HEAVY RAIN/FLOODING           
## [177] THUNDERSTORM WINDSS            TORNADOS                      
## [179] GLAZE                          RECORD HEAT                   
## [181] COASTAL FLOODING               HEAT WAVE                     
## [183] FIRST SNOW                     FREEZING RAIN AND SLEET       
## [185] UNSEASONABLY DRY               UNSEASONABLY WET              
## [187] WINTRY MIX                     WINTER WEATHER                
## [189] UNSEASONABLY COLD              EXTREME/RECORD COLD           
## [191] RIP CURRENTS HEAVY SURF        SLEET/RAIN/SNOW               
## [193] UNSEASONABLY WARM              DROUGHT                       
## [195] NORMAL PRECIPITATION           HIGH WINDS/FLOODING           
## [197] DRY                            RAIN/SNOW                     
## [199] SNOW/RAIN/SLEET                WATERSPOUT/TORNADO            
## [201] WATERSPOUTS                    WATERSPOUT TORNADO            
## [203] URBAN/SMALL STREAM FLOOD       STORM SURGE                   
## [205] WATERSPOUT-TORNADO             WATERSPOUT-                   
## [207] TORNADOES, TSTM WIND, HAIL     TROPICAL STORM ALBERTO        
## [209] TROPICAL STORM                 TROPICAL STORM GORDON         
## [211] TROPICAL STORM JERRY           LIGHTNING THUNDERSTORM WINDS  
## [213] WAYTERSPOUT                    MINOR FLOODING                
## [215] LIGHTNING INJURY               URBAN/SMALL STREAM  FLOOD     
## [217] LIGHTNING AND THUNDERSTORM WIN THUNDERSTORM WINDS53          
## [219] URBAN AND SMALL STREAM FLOOD   URBAN AND SMALL STREAM        
## [221] WILDFIRE                       DAMAGING FREEZE               
## [223] THUNDERSTORM WINDS 13          SMALL HAIL                    
## [225] HEAVY SNOW/HIGH WIND           HURRICANE                     
## [227] WILD/FOREST FIRE               SMALL STREAM FLOODING         
## [229] MUD SLIDE                      LIGNTNING                     
## [231] FROST                          FREEZING RAIN/SNOW            
## [233] HIGH WINDS/                    THUNDERSNOW                   
## [235] FLOODS                         EXTREME WIND CHILLS           
## [237] COOL AND WET                   HEAVY RAIN/SNOW               
## [239] SMALL STREAM AND URBAN FLOODIN SMALL STREAM/URBAN FLOOD      
## [241] SNOW/SLEET/FREEZING RAIN       SEVERE COLD                   
## [243] GLAZE ICE                      COLD WAVE                     
## [245] EARLY SNOW                     SMALL STREAM AND URBAN FLOOD  
## [247] HIGH  WINDS                    RURAL FLOOD                   
## [249] SMALL STREAM AND               MUD SLIDES                    
## [251] HAIL 80                        EXTREME WIND CHILL            
## [253] COLD AND WET CONDITIONS        EXCESSIVE WETNESS             
## [255] GRADIENT WINDS                 HEAVY SNOW/BLOWING SNOW       
## [257] SLEET/ICE STORM                THUNDERSTORM WINDS URBAN FLOOD
## [259] THUNDERSTORM WINDS SMALL STREA ROTATING WALL CLOUD           
## [261] LARGE WALL CLOUD               COLD AIR FUNNEL               
## [263] GUSTNADO                       COLD AIR FUNNELS              
## [265] BLOWING SNOW- EXTREME WIND CHI SNOW AND HEAVY SNOW           
## [267] GROUND BLIZZARD                MAJOR FLOOD                   
## [269] SNOW/HEAVY SNOW                FREEZING RAIN/SLEET           
## [271] ICE JAM FLOODING               SNOW- HIGH WIND- WIND CHILL   
## [273] STREET FLOOD                   COLD AIR TORNADO              
## [275] SMALL STREAM FLOOD             FOG                           
## [277] THUNDERSTORM WINDS 2           FUNNEL CLOUD/HAIL             
## [279] ICE/SNOW                       TSTM WIND 51                  
## [281] TSTM WIND 50                   TSTM WIND 52                  
## [283] TSTM WIND 55                   HEAVY SNOW/BLIZZARD           
## [285] THUNDERSTORM WINDS 61          HAIL 0.75                     
## [287] THUNDERSTORM DAMAGE            THUNDERTORM WINDS             
## [289] HAIL 1.00                      HAIL/WINDS                    
## [291] SNOW AND ICE                   WIND STORM                    
## [293] SNOWSTORM                      GRASS FIRES                   
## [295] LAKE FLOOD                     PROLONG COLD                  
## [297] HAIL/WIND                      HAIL 1.75                     
## [299] THUNDERSTORMW 50               WIND/HAIL                     
## [301] SNOW AND ICE STORM             URBAN AND SMALL STREAM FLOODIN
## [303] THUNDERSTORMS WIND             THUNDERSTORM  WINDS           
## [305] HEAVY SNOW/SLEET               AGRICULTURAL FREEZE           
## [307] DROUGHT/EXCESSIVE HEAT         TUNDERSTORM WIND              
## [309] TROPICAL STORM DEAN            THUNDERTSORM WIND             
## [311] THUNDERSTORM WINDS/ HAIL       THUNDERSTORM WIND/LIGHTNING   
## [313] HEAVY RAIN/SEVERE WEATHER      THUNDESTORM WINDS             
## [315] WATERSPOUT/ TORNADO            LIGHTNING.                    
## [317] WARM DRY CONDITIONS            HURRICANE-GENERATED SWELLS    
## [319] HEAVY SNOW/ICE STORM           RIVER AND STREAM FLOOD        
## [321] HIGH WIND 63                   COASTAL SURGE                 
## [323] HEAVY SNOW AND ICE STORM       MINOR FLOOD                   
## [325] HIGH WINDS/COASTAL FLOOD       RAIN                          
## [327] RIVER FLOODING                 SNOW/RAIN                     
## [329] ICE FLOES                      HIGH WAVES                    
## [331] SNOW SQUALLS                   SNOW SQUALL                   
## [333] THUNDERSTORM WIND G50          LIGHTNING FIRE                
## [335] BLIZZARD/FREEZING RAIN         HEAVY LAKE SNOW               
## [337] HEAVY SNOW/FREEZING RAIN       LAKE EFFECT SNOW              
## [339] HEAVY WET SNOW                 DUST DEVIL WATERSPOUT         
## [341] THUNDERSTORM WINDS/HEAVY RAIN  THUNDERSTROM WINDS            
## [343] THUNDERSTORM WINDS      LE CEN HAIL 225                      
## [345] BLIZZARD AND HEAVY SNOW        HEAVY SNOW AND ICE            
## [347] ICE STORM AND SNOW             HEAVY SNOW ANDBLOWING SNOW    
## [349] HEAVY SNOW/ICE                 BLIZZARD AND EXTREME WIND CHIL
## [351] LOW WIND CHILL                 BLOWING SNOW &amp; EXTREME WIND CH
## [353] WATERSPOUT/                    URBAN/SMALL STREAM            
## [355] TORNADO F3                     FUNNEL CLOUD.                 
## [357] TORNDAO                        HAIL 0.88                     
## [359] FLOOD/RIVER FLOOD              MUD SLIDES URBAN FLOODING     
## [361] TORNADO F1                     THUNDERSTORM WINDS G          
## [363] DEEP HAIL                      GLAZE/ICE STORM               
## [365] HEAVY SNOW/WINTER STORM        AVALANCE                      
## [367] BLIZZARD/WINTER STORM          DUST STORM/HIGH WINDS         
## [369] ICE JAM                        FOREST FIRES                  
## [371] THUNDERSTORM WIND G60          FROST\\FREEZE                 
## [373] THUNDERSTORM WINDS.            HAIL 88                       
## [375] HAIL 175                       HVY RAIN                      
## [377] HAIL 100                       HAIL 150                      
## [379] HAIL 075                       THUNDERSTORM WIND G55         
## [381] HAIL 125                       THUNDERSTORM WINDS G60        
## [383] HARD FREEZE                    HAIL 200                      
## [385] THUNDERSTORM WINDS FUNNEL CLOU THUNDERSTORM WINDS 62         
## [387] WILDFIRES                      RECORD HEAT WAVE              
## [389] HEAVY SNOW AND HIGH WINDS      HEAVY SNOW/HIGH WINDS &amp; FLOOD 
## [391] HAIL FLOODING                  THUNDERSTORM WINDS/FLASH FLOOD
## [393] HIGH WIND 70                   WET SNOW                      
## [395] HEAVY RAIN AND FLOOD           LOCAL FLASH FLOOD             
## [397] THUNDERSTORM WINDS 53          FLOOD/FLASH FLOODING          
## [399] TORNADO/WATERSPOUT             RAIN AND WIND                 
## [401] THUNDERSTORM WIND 59           THUNDERSTORM WIND 52          
## [403] COASTAL/TIDAL FLOOD            SNOW/ICE STORM                
## [405] BELOW NORMAL PRECIPITATION     RIP CURRENTS/HEAVY SURF       
## [407] FLASH FLOOD/FLOOD              EXCESSIVE RAIN                
## [409] RECORD/EXCESSIVE HEAT          HEAT WAVES                    
## [411] LIGHT SNOW                     THUNDERSTORM WIND 69          
## [413] HAIL DAMAGE                    LIGHTNING DAMAGE              
## [415] RECORD TEMPERATURES            LIGHTNING AND WINDS           
## [417] FOG AND COLD TEMPERATURES      OTHER                         
## [419] RECORD SNOW                    SNOW/COLD                     
## [421] FLASH FLOOD FROM ICE JAMS      TSTM WIND G58                 
## [423] MUDSLIDE                       HEAVY SNOW SQUALLS            
## [425] HEAVY SNOW/SQUALLS             HEAVY SNOW-SQUALLS            
## [427] ICY ROADS                      HEAVY MIX                     
## [429] SNOW FREEZING RAIN             LACK OF SNOW                  
## [431] SNOW/SLEET                     SNOW/FREEZING RAIN            
## [433] SNOW DROUGHT                   THUNDERSTORMW WINDS           
## [435] THUNDERSTORM WIND 60 MPH       THUNDERSTORM WIND 65MPH       
## [437] THUNDERSTORM WIND/ TREES       THUNDERSTORM WIND/AWNING      
## [439] THUNDERSTORM WIND 98 MPH       THUNDERSTORM WIND TREES       
## [441] TORRENTIAL RAIN                TORNADO F2                    
## [443] RIP CURRENTS                   HURRICANE EMILY               
## [445] HURRICANE GORDON               HURRICANE FELIX               
## [447] THUNDERSTORM WIND 59 MPH       THUNDERSTORM WINDS 63 MPH     
## [449] THUNDERSTORM WIND/ TREE        THUNDERSTORM DAMAGE TO        
## [451] THUNDERSTORM WIND 65 MPH       FLASH FLOOD - HEAVY RAIN      
## [453] THUNDERSTORM WIND.             FLASH FLOOD/ STREET           
## [455] THUNDERSTORM WIND 59 MPH.      HEAVY SNOW   FREEZING RAIN    
## [457] DAM FAILURE                    THUNDERSTORM HAIL             
## [459] HAIL 088                       THUNDERSTORM WINDSHAIL        
## [461] LIGHTNING  WAUSEON             THUDERSTORM WINDS             
## [463] ICE AND SNOW                   RECORD COLD/FROST             
## [465] STORM FORCE WINDS              FREEZING RAIN AND SNOW        
## [467] FREEZING RAIN SLEET AND        SOUTHEAST                     
## [469] HEAVY SNOW &amp; ICE               FREEZING DRIZZLE AND FREEZING 
## [471] THUNDERSTORM WINDS AND         HAIL/ICY ROADS                
## [473] FLASH FLOOD/HEAVY RAIN         HEAVY RAIN; URBAN FLOOD WINDS;
## [475] HEAVY PRECIPITATION            TSTM WIND DAMAGE              
## [477] HIGH WATER                     FLOOD FLASH                   
## [479] RAIN/WIND                      THUNDERSTORM WINDS 50         
## [481] THUNDERSTORM WIND G52          FLOOD FLOOD/FLASH             
## [483] THUNDERSTORM WINDS 52          SNOW SHOWERS                  
## [485] THUNDERSTORM WIND G51          HEAT WAVE DROUGHT             
## [487] HEAVY SNOW/BLIZZARD/AVALANCHE  RECORD SNOW/COLD              
## [489] WET WEATHER                    UNSEASONABLY WARM AND DRY     
## [491] FREEZING RAIN SLEET AND LIGHT  RECORD/EXCESSIVE RAINFALL     
## [493] TIDAL FLOOD                    BEACH EROSIN                  
## [495] THUNDERSTORM WIND G61          FLOOD/FLASH                   
## [497] LOW TEMPERATURE                SLEET &amp; FREEZING RAIN         
## [499] HEAVY RAINS/FLOODING           THUNDERESTORM WINDS           
## [501] THUNDERSTORM WINDS/FLOODING    THUNDEERSTORM WINDS           
## [503] HIGHWAY FLOODING               THUNDERSTORM W INDS           
## [505] HYPOTHERMIA                    FLASH FLOOD/ FLOOD            
## [507] THUNDERSTORM WIND 50           THUNERSTORM WINDS             
## [509] HEAVY RAIN/MUDSLIDES/FLOOD     MUD/ROCK SLIDE                
## [511] HIGH WINDS/COLD                BEACH EROSION/COASTAL FLOOD   
## [513] COLD/WINDS                     SNOW/ BITTER COLD             
## [515] THUNDERSTORM WIND 56           SNOW SLEET                    
## [517] DRY HOT WEATHER                COLD WEATHER                  
## [519] RAPIDLY RISING WATER           HAIL ALOFT                    
## [521] EARLY FREEZE                   ICE/STRONG WINDS              
## [523] EXTREME WIND CHILL/BLOWING SNO SNOW/HIGH WINDS               
## [525] HIGH WINDS/SNOW                EARLY FROST                   
## [527] SNOWMELT FLOODING              HEAVY SNOW AND STRONG WINDS   
## [529] SNOW ACCUMULATION              BLOWING SNOW/EXTREME WIND CHIL
## [531] SNOW/ ICE                      SNOW/BLOWING SNOW             
## [533] TORNADOES                      THUNDERSTORM WIND/HAIL        
## [535] FLASH FLOODING/FLOOD           HAIL 275                      
## [537] HAIL 450                       FLASH FLOOODING               
## [539] EXCESSIVE RAINFALL             THUNDERSTORMW                 
## [541] HAILSTORM                      TSTM WINDS                    
## [543] BEACH FLOOD                    HAILSTORMS                    
## [545] TSTMW                          FUNNELS                       
## [547] TSTM WIND 65)                  THUNDERSTORM WINDS/ FLOOD     
## [549] HEAVY RAINFALL                 HEAT/DROUGHT                  
## [551] HEAT DROUGHT                   NEAR RECORD SNOW              
## [553] LANDSLIDE                      HIGH WIND AND SEAS            
## [555] THUNDERSTORMWINDS              THUNDERSTORM WINDS HEAVY RAIN 
## [557] SLEET/SNOW                     EXCESSIVE                     
## [559] SNOW/SLEET/RAIN                WILD/FOREST FIRES             
## [561] HEAVY SEAS                     DUSTSTORM                     
## [563] FLOOD &amp; HEAVY RAIN             ?                             
## [565] THUNDERSTROM WIND              FLOOD/FLASHFLOOD              
## [567] SNOW AND COLD                  HOT PATTERN                   
## [569] PROLONG COLD/SNOW              BRUSH FIRES                   
## [571] SNOW\\COLD                     WINTER MIX                    
## [573] EXCESSIVE PRECIPITATION        SNOWFALL RECORD               
## [575] HOT/DRY PATTERN                DRY PATTERN                   
## [577] MILD/DRY PATTERN               MILD PATTERN                  
## [579] LANDSLIDES                     HEAVY SHOWERS                 
## [581] HEAVY SNOW AND                 HIGH WIND 48                  
## [583] LAKE-EFFECT SNOW               BRUSH FIRE                    
## [585] WATERSPOUT FUNNEL CLOUD        URBAN SMALL STREAM FLOOD      
## [587] SAHARAN DUST                   HEAVY SHOWER                  
## [589] URBAN FLOOD LANDSLIDE          HEAVY SWELLS                  
## [591] URBAN SMALL                    URBAN FLOODS                  
## [593] SMALL STREAM                   HEAVY RAIN/URBAN FLOOD        
## [595] FLASH FLOOD/LANDSLIDE          LANDSLIDE/URBAN FLOOD         
## [597] HEAVY RAIN/SMALL STREAM URBAN  FLASH FLOOD LANDSLIDES        
## [599] EXTREME WINDCHILL              URBAN/SML STREAM FLD          
## [601] TSTM WIND/HAIL                 Other                         
## [603] Record dry month               Temperature record            
## [605] Minor Flooding                 Ice jam flood (minor          
## [607] High Wind                      Tstm Wind                     
## [609] ROUGH SURF                     Wind                          
## [611] Heavy Surf                     Dust Devil                    
## [613] Wind Damage                    Marine Accident               
## [615] Snow                           Freeze                        
## [617] Snow Squalls                   Coastal Flooding              
## [619] Heavy Rain                     Strong Wind                   
## [621] COASTAL STORM                  COASTALFLOOD                  
## [623] Erosion/Cstl Flood             Heavy Rain and Wind           
## [625] Light Snow/Flurries            Wet Month                     
## [627] Wet Year                       Tidal Flooding                
## [629] River Flooding                 Damaging Freeze               
## [631] Beach Erosion                  Hot and Dry                   
## [633] Flood/Flash Flood              Icy Roads                     
## [635] High Surf                      Heavy Rain/High Surf          
## [637] Thunderstorm Wind              Rain Damage                   
## [639] Unseasonable Cold              Early Frost                   
## [641] Wintry Mix                     blowing snow                  
## [643] STREET FLOODING                Record Cold                   
## [645] Extreme Cold                   Ice Fog                       
## [647] Excessive Cold                 Torrential Rainfall           
## [649] Freezing Rain                  Landslump                     
## [651] Late-season Snowfall           Hurricane Edouard             
## [653] Coastal Storm                  Flood                         
## [655] HEAVY RAIN/WIND                TIDAL FLOODING                
## [657] Winter Weather                 Snow squalls                  
## [659] Strong Winds                   Strong winds                  
## [661] RECORD WARM TEMPS.             Ice/Snow                      
## [663] Mudslide                       Glaze                         
## [665] Extended Cold                  Snow Accumulation             
## [667] Freezing Fog                   Drifting Snow                 
## [669] Whirlwind                      Heavy snow shower             
## [671] Heavy rain                     LATE SNOW                     
## [673] Record May Snow                Record Winter Snow            
## [675] Heavy Precipitation             COASTAL FLOOD                
## [677] Record temperature             Light snow                    
## [679] Late Season Snowfall           Gusty Wind                    
## [681] small hail                     Light Snow                    
## [683] MIXED PRECIP                   Black Ice                     
## [685] Mudslides                      Gradient wind                 
## [687] Snow and Ice                   Freezing Spray                
## [689] Summary Jan 17                 Summary of March 14           
## [691] Summary of March 23            Summary of March 24           
## [693] Summary of April 3rd           Summary of April 12           
## [695] Summary of April 13            Summary of April 21           
## [697] Summary August 11              Summary of April 27           
## [699] Summary of May 9-10            Summary of May 10             
## [701] Summary of May 13              Summary of May 14             
## [703] Summary of May 22 am           Summary of May 22 pm          
## [705] Heatburst                      Summary of May 26 am          
## [707] Summary of May 26 pm           Metro Storm, May 26           
## [709] Summary of May 31 am           Summary of May 31 pm          
## [711] Summary of June 3              Summary of June 4             
## [713] Summary June 5-6               Summary June 6                
## [715] Summary of June 11             Summary of June 12            
## [717] Summary of June 13             Summary of June 15            
## [719] Summary of June 16             Summary June 18-19            
## [721] Summary of June 23             Summary of June 24            
## [723] Summary of June 30             Summary of July 2             
## [725] Summary of July 3              Summary of July 11            
## [727] Summary of July 22             Summary July 23-24            
## [729] Summary of July 26             Summary of July 29            
## [731] Summary of August 1            Summary August 2-3            
## [733] Summary August 7               Summary August 9              
## [735] Summary August 10              Summary August 17             
## [737] Summary August 21              Summary August 28             
## [739] Summary September 4            Summary September 20          
## [741] Summary September 23           Summary Sept. 25-26           
## [743] Summary: Oct. 20-21            Summary: October 31           
## [745] Summary: Nov. 6-7              Summary: Nov. 16              
## [747] Microburst                     wet micoburst                 
## [749] Hail(0.75)                     Funnel Cloud                  
## [751] Urban Flooding                 No Severe Weather             
## [753] Urban flood                    Urban Flood                   
## [755] Cold                           Summary of May 22             
## [757] Summary of June 6              Summary August 4              
## [759] Summary of June 10             Summary of June 18            
## [761] Summary September 3            Summary: Sept. 18             
## [763] Coastal Flood                  coastal flooding              
## [765] Small Hail                     Record Temperatures           
## [767] Light Snowfall                 Freezing Drizzle              
## [769] Gusty wind/rain                GUSTY WIND/HVY RAIN           
## [771] Blowing Snow                   Early snowfall                
## [773] Monthly Snowfall               Record Heat                   
## [775] Seasonal Snowfall              Monthly Rainfall              
## [777] Cold Temperature               Sml Stream Fld                
## [779] Heat Wave                      MUDSLIDE/LANDSLIDE            
## [781] Saharan Dust                   Volcanic Ash                  
## [783] Volcanic Ash Plume             Thundersnow shower            
## [785] NONE                           COLD AND SNOW                 
## [787] DAM BREAK                      TSTM WIND (G45)               
## [789] SLEET/FREEZING RAIN            BLACK ICE                     
## [791] BLOW-OUT TIDES                 UNSEASONABLY COOL             
## [793] TSTM HEAVY RAIN                Gusty Winds                   
## [795] GUSTY WIND                     TSTM WIND 40                  
## [797] TSTM WIND 45                   TSTM WIND (41)                
## [799] TSTM WIND (G40)                TSTM WND                      
## [801] Wintry mix                      TSTM WIND                    
## [803] Frost                          Frost/Freeze                  
## [805] RAIN (HEAVY)                   Record Warmth                 
## [807] Prolong Cold                   Cold and Frost                
## [809] URBAN/SML STREAM FLDG          STRONG WIND GUST              
## [811] LATE FREEZE                    BLOW-OUT TIDE                 
## [813] Hypothermia/Exposure           HYPOTHERMIA/EXPOSURE          
## [815] Lake Effect Snow               Mixed Precipitation           
## [817] Record High                    COASTALSTORM                  
## [819] Snow and sleet                 Freezing rain                 
## [821] Gusty winds                    Blizzard Summary              
## [823] SUMMARY OF MARCH 24-25         SUMMARY OF MARCH 27           
## [825] SUMMARY OF MARCH 29            GRADIENT WIND                 
## [827] Icestorm/Blizzard              Flood/Strong Wind             
## [829] TSTM WIND AND LIGHTNING        gradient wind                 
## [831] Freezing drizzle               Mountain Snows                
## [833] URBAN/SMALL STRM FLDG          Heavy surf and wind           
## [835] Mild and Dry Pattern           COLD AND FROST                
## [837] TYPHOON                        HIGH SWELLS                   
## [839] HIGH  SWELLS                   VOLCANIC ASH                  
## [841] DRY SPELL                       LIGHTNING                    
## [843] BEACH EROSION                  UNSEASONAL RAIN               
## [845] EARLY RAIN                     PROLONGED RAIN                
## [847] WINTERY MIX                    COASTAL FLOODING/EROSION      
## [849] HOT SPELL                      UNSEASONABLY HOT              
## [851]  TSTM WIND (G45)               TSTM WIND  (G45)              
## [853] HIGH WIND (G40)                TSTM WIND (G35)               
## [855] DRY WEATHER                    ABNORMAL WARMTH               
## [857] UNUSUAL WARMTH                 WAKE LOW WIND                 
## [859] MONTHLY RAINFALL               COLD TEMPERATURES             
## [861] COLD WIND CHILL TEMPERATURES   MODERATE SNOW                 
## [863] MODERATE SNOWFALL              URBAN/STREET FLOODING         
## [865] COASTAL EROSION                UNUSUAL/RECORD WARMTH         
## [867] BITTER WIND CHILL              BITTER WIND CHILL TEMPERATURES
## [869] SEICHE                         TSTM                          
## [871] COASTAL  FLOODING/EROSION      UNSEASONABLY WARM YEAR        
## [873] HYPERTHERMIA/EXPOSURE          ROCK SLIDE                    
## [875] ICE PELLETS                    PATCHY DENSE FOG              
## [877] RECORD COOL                    RECORD WARM                   
## [879] HOT WEATHER                    RECORD TEMPERATURE            
## [881] TROPICAL DEPRESSION            VOLCANIC ERUPTION             
## [883] COOL SPELL                     WIND ADVISORY                 
## [885] GUSTY WIND/HAIL                RED FLAG FIRE WX              
## [887] FIRST FROST                    EXCESSIVELY DRY               
## [889] SNOW AND SLEET                 LIGHT SNOW/FREEZING PRECIP    
## [891] VOG                            MONTHLY PRECIPITATION         
## [893] MONTHLY TEMPERATURE            RECORD DRYNESS                
## [895] EXTREME WINDCHILL TEMPERATURES MIXED PRECIPITATION           
## [897] DRY CONDITIONS                 REMNANTS OF FLOYD             
## [899] EARLY SNOWFALL                 FREEZING FOG                  
## [901] LANDSPOUT                      DRIEST MONTH                  
## [903] RECORD  COLD                   LATE SEASON HAIL              
## [905] EXCESSIVE SNOW                 DRYNESS                       
## [907] FLOOD/FLASH/FLOOD              WIND AND WAVE                 
## [909] LIGHT FREEZING RAIN             WIND                         
## [911] MONTHLY SNOWFALL               RECORD PRECIPITATION          
## [913] ICE ROADS                      ROUGH SEAS                    
## [915] UNSEASONABLY WARM/WET          UNSEASONABLY COOL &amp; WET       
## [917] UNUSUALLY WARM                 TSTM WIND G45                 
## [919] NON SEVERE HAIL                NON-SEVERE WIND DAMAGE        
## [921] UNUSUALLY COLD                 WARM WEATHER                  
## [923] LANDSLUMP                      THUNDERSTORM WIND (G40)       
## [925] UNSEASONABLY WARM &amp; WET         FLASH FLOOD                  
## [927] LOCALLY HEAVY RAIN             WIND GUSTS                    
## [929] UNSEASONAL LOW TEMP            HIGH SURF ADVISORY            
## [931] LATE SEASON SNOW               GUSTY LAKE WIND               
## [933] ABNORMALLY DRY                 WINTER WEATHER MIX            
## [935] RED FLAG CRITERIA              WND                           
## [937] CSTL FLOODING/EROSION          SMOKE                         
## [939]  WATERSPOUT                    SNOW ADVISORY                 
## [941] EXTREMELY WET                  UNUSUALLY LATE SNOW           
## [943] VERY DRY                       RECORD LOW RAINFALL           
## [945] ROGUE WAVE                     PROLONG WARMTH                
## [947] ACCUMULATED SNOWFALL           FALLING SNOW/ICE              
## [949] DUST DEVEL                     NON-TSTM WIND                 
## [951] NON TSTM WIND                  GUSTY THUNDERSTORM WINDS      
## [953] PATCHY ICE                     HEAVY RAIN EFFECTS            
## [955] EXCESSIVE HEAT/DROUGHT         NORTHERN LIGHTS               
## [957] MARINE TSTM WIND                  HIGH SURF ADVISORY         
## [959] HAZARDOUS SURF                 FROST/FREEZE                  
## [961] WINTER WEATHER/MIX             ASTRONOMICAL HIGH TIDE        
## [963] WHIRLWIND                      VERY WARM                     
## [965] ABNORMALLY WET                 TORNADO DEBRIS                
## [967] EXTREME COLD/WIND CHILL        ICE ON ROAD                   
## [969] DROWNING                       GUSTY THUNDERSTORM WIND       
## [971] MARINE HAIL                    HIGH SURF ADVISORIES          
## [973] HURRICANE/TYPHOON              HEAVY SURF/HIGH SURF          
## [975] SLEET STORM                    STORM SURGE/TIDE              
## [977] COLD/WIND CHILL                MARINE HIGH WIND              
## [979] TSUNAMI                        DENSE SMOKE                   
## [981] LAKESHORE FLOOD                MARINE THUNDERSTORM WIND      
## [983] MARINE STRONG WIND             ASTRONOMICAL LOW TIDE         
## [985] VOLCANIC ASHFALL              
## 985 Levels:    HIGH SURF ADVISORY  COASTAL FLOOD ... WND
</code></pre>

<pre><code class="r">length(unique(data$EVTYPE))
</code></pre>

<pre><code>## [1] 985
</code></pre>

<p>As we can see, this column contains some irreleval values, mistakes, etc. Size of error them introduce is not huge, so we will perform only some basic cleaning:</p>

<pre><code class="r">data &lt;- mutate(data, EVTYPE = toupper(EVTYPE))
length(unique(data$EVTYPE))
</code></pre>

<pre><code>## [1] 898
</code></pre>

<h4>FATALITIES, INJURIES</h4>

<p>Let&#39;s exam FATALITIES and INJURIES columns:</p>

<pre><code class="r">summary(data$FATALITIES)
</code></pre>

<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##   0.0000   0.0000   0.0000   0.0168   0.0000 583.0000
</code></pre>

<pre><code class="r">summary(data$INJURIES)
</code></pre>

<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##    0.0000    0.0000    0.0000    0.1557    0.0000 1700.0000
</code></pre>

<p>As we can see, they are ready for processing.</p>

<h4>PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP</h4>

<p>PROPDMG/CROPDMG describes value of damages causes and PROPDMGEXP/CROPDMGEXP describes magnitude as following:</p>

<ul>
<li>K for $1000</li>
<li>M for $1000000</li>
<li>B for $1000000000</li>
</ul>

<p>So we need to merge them into single variable to perform effective furter analysys.</p>

<pre><code class="r">data &lt;- mutate(data, 
    PROPERTY_DAMAGE = PROPDMG * ifelse(PROPDMGEXP == &#39;B&#39;, 1000000000, ifelse(PROPDMGEXP == &#39;M&#39;, 1000000, ifelse(PROPDMGEXP == &#39;K&#39;, 1000, 1))), 
    CROP_DAMAGE = CROPDMG * ifelse(CROPDMGEXP == &#39;B&#39;, 1000000000, ifelse(CROPDMGEXP == &#39;M&#39;, 1000000, ifelse(CROPDMGEXP == &#39;K&#39;, 1000, 1)))
)
</code></pre>

<pre><code class="r">summary(data$PROPERTY_DAMAGE)
</code></pre>

<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.000e+00 0.000e+00 0.000e+00 4.735e+05 5.000e+02 1.150e+11
</code></pre>

<pre><code class="r">summary(data$CROP_DAMAGE)
</code></pre>

<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.000e+00 0.000e+00 0.000e+00 5.441e+04 0.000e+00 5.000e+09
</code></pre>

<h4>Per event damages</h4>

<p>Using dplyr grouping, let&#39;s group different measurements of damage by their event types:</p>

<pre><code class="r">data_per_type &lt;- summarise(group_by(data, EVTYPE), 
    TOTAL_FATALITIES = sum(FATALITIES), 
    TOTAL_INJURIES = sum(INJURIES),
    TOTAL_PROPERTY_DAMAGE = sum(PROPERTY_DAMAGE),
    TOTAL_CROP_DAMAGE = sum(CROP_DAMAGE)
)
data_per_type
</code></pre>

<pre><code>## Source: local data frame [898 x 5]
## 
##                   EVTYPE TOTAL_FATALITIES TOTAL_INJURIES
## 1     HIGH SURF ADVISORY                0              0
## 2          COASTAL FLOOD                0              0
## 3            FLASH FLOOD                0              0
## 4              LIGHTNING                0              0
## 5              TSTM WIND                0              0
## 6        TSTM WIND (G45)                0              0
## 7             WATERSPOUT                0              0
## 8                   WIND                0              0
## 9                      ?                0              0
## 10       ABNORMAL WARMTH                0              0
## ..                   ...              ...            ...
## Variables not shown: TOTAL_PROPERTY_DAMAGE (dbl), TOTAL_CROP_DAMAGE (dbl)
</code></pre>

<h4>Total value</h4>

<p>In the end, to simplify further processing, let&#39;s calculate some summary damage measurements. Heuristically, we will think about fatality 5 times worse as injury and property damage equal to crop:</p>

<pre><code class="r">data_per_type &lt;- mutate(data_per_type,
    TOTAL_POPULATION_DAMAGE = 5 * TOTAL_FATALITIES + TOTAL_INJURIES,
    TOTAL_ECONOMICAL_DAMAGE = TOTAL_PROPERTY_DAMAGE + TOTAL_CROP_DAMAGE
)
data_per_type
</code></pre>

<pre><code>## Source: local data frame [898 x 7]
## 
##                   EVTYPE TOTAL_FATALITIES TOTAL_INJURIES
## 1     HIGH SURF ADVISORY                0              0
## 2          COASTAL FLOOD                0              0
## 3            FLASH FLOOD                0              0
## 4              LIGHTNING                0              0
## 5              TSTM WIND                0              0
## 6        TSTM WIND (G45)                0              0
## 7             WATERSPOUT                0              0
## 8                   WIND                0              0
## 9                      ?                0              0
## 10       ABNORMAL WARMTH                0              0
## ..                   ...              ...            ...
## Variables not shown: TOTAL_PROPERTY_DAMAGE (dbl), TOTAL_CROP_DAMAGE (dbl),
##   TOTAL_POPULATION_DAMAGE (dbl), TOTAL_ECONOMICAL_DAMAGE (dbl)
</code></pre>

<h2>Results</h2>

<h3>Population damage</h3>

<p>Let&#39;s first look at top 10 event types that causes fatalities:</p>

<pre><code class="r">ggplot(
    slice(arrange(data_per_type, desc(TOTAL_FATALITIES)), 1:10), 
    aes(x = reorder(EVTYPE, TOTAL_FATALITIES), y = TOTAL_FATALITIES)
) + 
geom_bar(stat=&quot;identity&quot;) + 
coord_flip() + 
labs(x = &#39;Event type&#39;) +
labs(y = &#39;Fatalities number&#39;) +
labs(title = &#39;Total fatalities number caused by top 10 event types&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABO1BMVEUAAAAAADoAAGYAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OmY6OpA6kJA6kNtmAABmADpmAGZmOgBmZmZmkJBmtv9/f39/f5V/f6t/lcF/q8F/q9aQOgCQOjqQZgCQkGaQtpCQ29uQ2/+Vf3+Vf5WVf6uVlZWVlauVlcGVq9aVwdaVweurf3+rf5Wrf6urlZWrlaurlcGrq6urq9arwcGrwdarweur1tar1uur1v+2ZgC2Zjq225C2/7a2/9u2///BlX/BlZXBlavBq8HBwavB1sHB69bB6+vB6//Wq3/Wq5XWq6vWwZXW1qvW6//W/9bW/+vW///bkDrbkJDb29vb/7bb///l5eXrwZXrwavr1qvr68Hr/9br/+vr///y8vL/tmb/1qv/25D/68H/69b//7b//9b//9v//+v///9Z47MPAAAACXBIWXMAAAsSAAALEgHS3X78AAAXUUlEQVR4nO2cDX8bx3HGIUUsrbqUZIe0FCq1yziq6JOV0mmbgq1LSk1TkkkcE01VtJZYgjQh7vf/BN3Xe5mhwOPhZnDEPc9PwuHudu+Zmz92b0GJMzBQLzVYdADQYgTwPRXA91QA31MBfE8F8D0VwPdUAN9TAXxPBfA9FcD3VADfUwF8TwXwPRXA91QA31MBfE/VdfB/vunpazosQi2G9Geyba5OgR8NgtbTgfdP1/KTFw+3/PZ0MFi7+rT9446khrV18WD9+kbX6PTu3gcuVQ6SnVr3r8UdzVa61IxL1lanwFudfVSmdhX43ZUZpxulZFHgLfF197piu9UKuwfg3Si498a9rpizVT8JRPC7g8HdvXCInr54+DfuiGsY+vs55E74vFw8/GLVvfdoLKazjz63bU/dFS4e/HR14MDFXu9//nnsZa/trpIsYtd01WRy8WBw5/MEPlzKfzpHK/FOVlJTH0Ro6WL7ySfr8Y5P3XXy+w7dd6vd7myFS8VLRof8ivyOZ6ub4N0oMLuO/FpI9+7dvdKIT4fI6WKq90NidO+No5SPRcfj3psc/OqKfWqsOEN/ahQu53q9fxox2LYVi9g1XrVovhaunlxGoUmYyP3wTPeTTvur/+eeb+GZn93fS21T3NHc7abYyyM+OtDYS3c8W90E7/OQ7tzptAI+HSKnC/CnYQysl1KQqBXgwxC2f/0h+5J6lS+bB3ZaBZ/OJpPyVB8vWYKZ7iedjtf04EcefJjo0iVdk2QUd8v3mz6N9rI09lrQnboJ3o8Ce3vhTu1UOiDgwyFyugAfV4lrbv6LWWbgrZG7pMPx0M/ba0Wv2GcUR36yyPPvr5qaj0pDNl3KRTkKn1A/POP95KdNPEXAp0u67u4Kcfcq8NGBx15aG89S98HbpK+REZ8OkdMl8ImYWxOER14d8PmDtgo+t0jP+HDV1PxK8Gf3/zVe5Trw5ak+j/v07rfWbFQ8cjj44EBjL93xbHUTfHmq94mpgk+HyGky1UfFbM0CX54uTQl8mtOTRQHeXTU1v2qqt+d/en8v95811ftzcXGXx20XifeLh/WV4IMDjb10x7PVTfDlxZ27pbPVO1tl8PEQOV1e3NlEnt7xH4A4ixbJc4tlAj6tnUKvHLzrMyrbha7xqkXzleribjesruNahC3udvPB6Y3KX+fSJWP3tHsl+NCExl6649nqJvjSl5MV/wXu2zghm/CMj4fIaddiVHydc/nbzX8clA9X9+Xri/vVqf6L8LUt9srBu+9xDmiyi13TVZOJ3eZf59KljFs8Bo1KX+cefBruK4j/ACddMnaPu6XvkSv5JUOT/Ir8jmera+CXRvGpXVUbPyqqOjS+IsALaXTVc7ZV8KO1ea4I8CI6Wy0m9JJaBB8dbiH4/6biR2rr/5p3XZDtHK4NbUn6AR7gldVmLgC+hmNVAA/wymozFwBfw7EqgAd4ZbHI/gJqUQDfUwF8TwXwPRXA91QA31MBfE8F8D0VwPdUAN9TAXxPBfA9FcD3VADfUwF8TwXwPRXA91QA31NJg59sOA3N5f7GxuNjc/4Lu7dpzn95bMzh0IQ3/qDdiW0AXkPyI3760rKcvrBgJ4+Pz7ct31cH58+2A/jDbzIL3u5Mvz5IbQBeQ0rgJ5l7O84S+O3x0IGf7ry1Z91Bey61sS9ulmAXWnSqlkvXYWsJvOVsHP401W/boxb82P/x4CdZahP7YcSLSn/ET3dOHOrJ5uFw+sJ+DJ6chBE/LI14gBfXAp7xk00/xg83hvade9T7Z/zLYzzjNaUEPl/VbzvU/lE/ffFPrw7s3uTJD1jV60sefFMBvKgAvqcC+J4K4HsqgO+pAL6nAvieCuB7KoDvqQC+pwL4ngrgeyqA76kAvqe6ReBR507UlqQf4AFeWW3mAuBrOFYF8ACvLBbZgtY/AK8sFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1JP8ADvLJYZAAvakvSD/AArywWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUk/wAO8slhkAC9qS9IP8ABflS9ctjEcPzlxRW38bpYOmnEoahM205ff77tKZrHYjTsRa+EMU/tQ4TJVwQT4ToN/fuK348zVMpt+fWAu94fxoNu4MoZhM315nMpbxT4F+HTAV7hMhZIA/jaAN0f/vp1Xp0vgvzwobSxNi9+d+yD4UOGyAN+NypYfuvVeaPZU74qTebyhKmV+0FUu3DRx42jaD8Y4K/qkZ0I6ECpcYsQX6v6In778k6Xlq1L++F0xpP2DP2wczfPn714fmw+N+FjhEuALdR68fbDbVdtJeMZn8eDEr/iGceNpHv1203wQfFwCAHyhDoP3k/VX+25cHz45Ka/qM7+cz0zchGK2nx2Y/DRZ1X8VK1yeAHyu7oIXF4sM4EVtSfoBHuCVxSIDeFFbkn6AB3hlscgAXtSWpB/gAV5ZLDKAF7Ul6Qd4gFcWiwzgRW1J+gEe4JXFIgN4UVuSfoAHeGWxyABe1JakH+ABXllt5gLlzmo4VgXwAK+sNnMB8DUcqwJ4gFcWi2yOVRrA13CsCuABXlksMoAXtSXpB3iAVxaLDOBFbUn6AR7glcUiA3hRW5J+gAd4ZbHIAF7UlqQf4AFeWSwygBe1JekHeIBXFosM4EVtSfoBHuCVxSIDeFFbkn6AB3hlscgAXtSWpP8m4H1Fm1QAKRSrjMUtY8kb2uZyP1Q/i1t/LhW2BHhl23nAb/vXCN4Xq0w1LgvwpTbTF/bI5PFx2rpzrnwWwN9m8KFYZapxeSV4XxzPjLO09ed8jcyWK1ve4B6gqJtO9XbcBvCxWGUobnleVC8utQnlMCdZ2nrw4VNgMOK1becBv+1f4zQei1UaV9zyJiNeoHo1wNdxbAd8LFYZi1ve4BmflzhkkQG8qO384N20/rNUrDIUt2TgXZtNrOpFXPE9HuBv5FgVwAO8slhkAC9qS9IP8ACvLBYZwIvakvQDPMAri0UG8KK2JP0AD/DKYpEBvKgtST/AA7yyWGQAL2pL0g/wAK8sFhnAi9qS9AM8wCurzVwAfA3HqgAe4JXVZi4AvoZjVQAP8MpikTVd2TVORUxI864A30QsMoAXtSXpB3iAVxaLDOBFbUn6AR7glcUiA3hRW5J+gAd4ZbHIAF7UlqQf4AFeWSwygBe1JekHeIBXFosM4EVtSfoBHuCVxSIDeFFbkn6AB3hlscgAXtSWpB/gAV5ZLDKAF7Ul6RcCH6sh5fXvfP3TycZGqfoRiwzgRW11wcfyp6H+abnYGcBr2y4EfKh/WoBvs6SpzA0svaTAhznebx4fp/qnGPFtuN6iEZ/XPwX4FlxvEfhY/xTgW3G9FeD9jP9Vqn8K8G24dhp8DbHIAF7UlqQf4AFeWSwygBe1JekHeIBXFosM4EVtSfoBHuCVxSIDeFFbkn6AB3hlscgAXtSWpB/gAV5ZLDKAF7Ul6Qd4gFcWiwzgRW1J+gEe4JXVZi4AvoZjVQAP8MpqMxcAX8OxKoAHeGWxyJqs6uZKRUxI864A30QsMoAXtSXpB3iAVxaLDOBFbUn6AR7glcUiA3hRW5J+gAd4ZbHIAF7UlqQf4AFeWSwygBe1JekHeIBXFosM4EVtSfoBHuCd3j8d3Puvh1sAX0vLA/7907Wzj9+c3nsD8HW0POAvHu1Z8PYV4OtoecCHET/CiK+n5QHvnvGDQU3uobKRK2tzue8rVsbCN7GApS9meTi05+O71Azg53Nd+Ko+B3+57wpafX0QwcfiVufPthP48C41A/j5XLsD3lczM3mpqwR+ezyM4MO71My0VNmyeeTQ1VP9Sr2uBfjMz+JFyeII3m4ieP8uNYvd2UcSI17UdiZ4u7izr6N65MmIHw/piDeTzQjev0vNAH4+V6Gvc/lrffCX+5mxg5mDN4cbEbx7l5oB/HyuIs94P9jrjng3s296yIflVX0J/PRFAm/fpWYAP5+ryIh/MAi6K/8jHBYZwIvazgSvKRYZwIvakvQDPMAbN9XX/CoH8HPadgy8MaeDwR2Vf5UFeGXba8Cb8EOcdYCvoWUCf7bqRrzGP8yyyABe1HYm+IsHKv8iC/CdA3+Tn9wB/LKAz398g/+IUU/LAl5rrAN858BrikUG8KK2JP0AD/DKYpEBvKgtSX+HVvUodyZqOwP8glf1AC9qOwP8glf1AC9qOxO8ptrMBcDXcKyKgD/V+v83N17cCaQiJqR51+UBf/FA4Z/lAH4+16V7xgO8qO1M8GZ3DeDra3nAxy90eMbX0/KA1xSLDOBFbUn6AR7gnbpbA0cgFTEhzbsuD/gO18ARSEVMSPOuywO+wzVwBFIRE9K86/KA73ANHIFUxIQ077o84G9UAwfglwi8olhkAC9qS9IP8ABvOv0LFQKpiAlp3nV5wPtfoapb/Ajglwm80yl+Vl9PywS+7oiP5SvN2L+mYpa/yNypz1wNw6MDc/6l/fv8bV7a0hfNaVoDRyAVMSHNuy4P+Js840OFo+cn5vLVQdr727+zr0fPHPix/VB8k5lJVpS29EWQmla2FEhFTEjzrssD/iYKqL88qHwM/jA05//gPgiu6NXR73ZOjg6K0pa+KtbYTQoNKls2jhO6UpX/Xv1oz5x9/Kbm/8PxqM30xcbGpsnB/7Bt/uc/PPjpztudd6+/f31clLb04CdZ7M8+khjxorYtg3c6zHLwFvW/vfPgze//mJnxb35titKWYcQ3LHAokIqYkOZdewx+8uSkXNPw+cn47//xMoAfP7PT/q8yU5S29M/4/OPCIgN4Udt2wftVfWYK8PahH8G7pbxbyhWlLbGqb8V10eDnFYsM4EVtZ4FXLGgK8Nq2M8DrikUG8KK2JP0AD/DKYpEBvKgtST/AA7yyWGQAL2pL0g/wAK8sFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1JP8ADvLLazAXA13CsCuABXllt5gLgazhWBfAAr6w2cwHwNRyr6hD4xmt6gK/lWBXAA7yyWGQAL2pL0g/wAK8sFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1JP8ADvLJYZAAvakvSD/AArywWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUl/2+B9gaPMFby0utzf2Hh8nG/nKH4kkoqYkOZdAb4Eftu/evDTF5by5PFx2s5R0lQkFTEhzbsC/NXgQxHLcZa2c5Q0bTlKSGSqt2Pbgw9FLCdZ2s5R0lRkDMSR0LwrRnwJ/LZ/nTHiG5U0FUlFTEjzrgB/Nfgrn/HNSpqKpCImpHlXgGfg3fp9E6t6Eddugq8vFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1JP8ADvLJYZAAvakvSD/AArywWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUk/wAO8strMBcDXcKwK4AFeWW3mAuBrOFYF8ACvLBZZo2XdPKmICWneFeCbiEUG8KK2JP0AD/DKYpEBvKgtST/AA7yyWGQAL2pL0g/wAK8sFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1JP8ADvLJYZAAvakvSD/AArywWGcCL2pL0AzzA11CsbTN9eezfPTlJB7NQ/OZwGFuUNxvD818eu3OTjY1SERwWGcCL2s4H3tK9fHXgwLu6Vr5YoatVebk/TOBDi7QJpU3Pn227c+WaVwCvbds6+HGWn/og+O3xsAL+BpUtbxQfVFvzT/WxYuGHp3pX4M72wIhvyXVBI366c2LSiPfydSt//M6DPzqILdImjXgz2QT4llwXNdVPNqvgwzM+c0zd8dAibXLw5nAD4NtxXRR4c5hVwMdVvZn4FXtskTZ+Ve/3fF1TgG/BFd/j501FTEjzrgDfRCwygBe1JekHeIBXFosM4EVtSfoBHuCVxSIDeFFbkn6AB3hlscgAXtSWpB/gAV5ZLDKAF7Ul6Qd4gFcWiwzgRW1J+gEe4JXFIgN4UVuS/g6BR7kzUVuSfoAHeGW1mQuAr+FYFcADvLJYZA0WdfOlIiakeVeAbyIWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUk/wAO8slhkAC9qS9IP8ACvLBYZwIvakvQDPMAri0UG8KK2JP0AD/DKYpEBvKgtST/AA7yyWGQAL2pL0g/wAH9zxRJnrrLN5X6pBI4rgHZ0YM6/tH+fv315HCtb+oo4qbAlwCvbyoC/3B/6+lcF+PHQjL/JzMRXSgqVLX0NpK8PAH4+106Bn2xWjoR3R7/bOTnyZTBDZUt/0hfCrFHZcp64oOs1H/hQo9iBz/xkP4xH7Lnpztudd6+/f33swfvKlh78JIud2UcSI17UtlXwjmRpxI+HxYg3v/9jZsa/+XWseugqW4YRX7N6tUIqYkKadwV4+4y3A7moYe0/Bc/sWu9XWSp3ebgRnvF5iUMWGcCL2sqAd2Crq3rjlvJuKRfBT19gVd+OawfAzyUWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUk/wAO8slhkAC9qS9IP8ACvLBYZwIvakvQDPMAri0UG8KK2JP0AD/DKYpEBvKgtST/AA7yy2swFwNdwrArgAV5ZbeYC4Gs4VgXwAK+sNnMB8DUcq+oQ+OaLeoCv41gVwAO8slhkAC9qS9IP8ACvLBYZwIvakvQDPMAri0UG8KK2JP0AD/DKYpEBvKgtST/AA7yyWGQAL2pL0g/wAK8sFhnAi9qS9AM8wCuLRQbworYk/QAP8MpikQG8qC1Jf0PwrrKRr2ZpJk9O/J45f36SnzKxiKmvhJelkkhFETyAv63gD7/JLPNNE0pc+b0EPuyEIqau6lVRBC21APhbC36689YVLn514HGHvYg17oQipuNQxpKBv76kaaOwoPpqBt5VKB76urQObdiLWONOKGIay1jGOd5vHtcrcKgxBuJIaN61dyN++sISdM/25+9eH6e9AD7thCKmvnDtj99hqm/TdYHg84f70W83872ANe1s+yKm4RmfAXybrosD757tYTk/+ewg3/vBTeQ/SzvbvojpVav6etWrNVIRE9K8a9/AtyMWGcCL2pL0AzzAK4tFBvCitiT9AA/wymKRAbyoLUk/wAO8slhkAC9qS9IP8ACvLBYZwIvakvQDPMAri0UG8KK2JP0AD/DKYpEBvKgtST/AA7yy2swFwNdwrArgAV5ZbeYC4Gs4VgXwAK+sNnMB8DUcqwJ4gF+0+K9YLLHtgm62EMAD/KIF8JoCeICH+iSA76kAvqcC+J4K4HuqzoA/3PjsQM3sct//fn/wLL9Ky9WR0He9Sl0BP3ly4n7vWstt0/3advAs/xH33ciMvuuV6gp4OxSmL4+vb9ei4zB4ll+FLc+f/29m1F2vVmfAD83la80U2EEfPMuvspaW8SRTd/2AOgNe+bN/uGnUx97YFwTBiK9I92mX12bUftpO8IynUl3fHoZiPPrr6wlW9dBiBfA9FcD3VADfUwF8TwXwZ6sDq7W0d3+veJf/ucHldtdbjk9IAF/lWgHPztYQwN8WJbRu5K9fPBjc3fPvwoj/1u7/i23gjxtzOvAb2/jjv45t3N/3P//czhmnft7Y/dSdiB3O/vKTuzf84GgJ4CP4i4dbcXYv3hVT/e6aGa2Yi0d7buM6ra6Z03tvEvinK/bIir/UbjgaOpytdnb8A7x/xnuaDmz6GDyqgHefBXvIbWKnQDwf8VvG/XXn3VS/ux473PhBoSeAz+Hsunnc76V3BfgH9sNxZ8t9SO5spU5Xg//nLQ8+dAD4DiuN8QfraarP3xXgH+UA7QRvrhnx75+uxw4A32FFOJ7hR1uJZnpXPOMtcQe9At6RHt2tgo+P+nwN0FEBfIIzGgx+8sn6+6d398K7gNzux1W9m+N381V9AO86/dWjKvhPfcvQAeChrgngeyqA76kAvqcC+J4K4HsqgO+pAL6nAvieCuB7qv8HVQehbqMFXCcAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-11"/> </p>

<p>Or, more detailed, table with top 20 event types:</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_FATALITIES)), 1:20), EVTYPE, TOTAL_FATALITIES)
</code></pre>

<pre><code>## Source: local data frame [20 x 2]
## 
##                     EVTYPE TOTAL_FATALITIES
## 1                  TORNADO             5633
## 2           EXCESSIVE HEAT             1903
## 3              FLASH FLOOD              978
## 4                     HEAT              937
## 5                LIGHTNING              816
## 6                TSTM WIND              504
## 7                    FLOOD              470
## 8              RIP CURRENT              368
## 9                HIGH WIND              248
## 10               AVALANCHE              224
## 11            WINTER STORM              206
## 12            RIP CURRENTS              204
## 13               HEAT WAVE              172
## 14            EXTREME COLD              162
## 15       THUNDERSTORM WIND              133
## 16              HEAVY SNOW              127
## 17 EXTREME COLD/WIND CHILL              125
## 18               HIGH SURF              104
## 19             STRONG WIND              103
## 20                BLIZZARD              101
</code></pre>

<p>Now, let&#39;s look at top 10 event types that causes injuries:</p>

<pre><code class="r">ggplot(
    slice(arrange(data_per_type, desc(TOTAL_INJURIES)), 1:10), 
    aes(x = reorder(EVTYPE, TOTAL_INJURIES), y = TOTAL_INJURIES)
) + 
geom_bar(stat=&quot;identity&quot;) + 
coord_flip() + 
labs(x = &#39;Event type&#39;) +
labs(y = &#39;Injuries number&#39;) +
labs(title = &#39;Total injuries number caused by top 10 event types&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABOFBMVEUAAAAAADoAAGYAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OmY6OpA6kJA6kNtmAABmADpmAGZmOgBmZmZmkJBmtv9/f39/f5V/f6t/lcF/q8F/q9aQOgCQOjqQZgCQkGaQtpCQ27aQ2/+Vf3+Vf5WVf6uVlZWVlauVlcGVq9aVwdaVweurf3+rf5Wrf6urlZWrlaurlcGrq6urq9arwcGrwdarweur1tar1uur1v+2ZgC2Zjq225C2/7a2/9u2///BlX/BlZXBlavBq8HBwavB1sHB69bB6+vB6//Wq3/Wq5XWq6vWwZXW1qvW6//W/9bW/+vW///bkDrbkJDb29vb/7bb///l5eXrwZXrwavr68Hr/9br/+vr///y8vL/tmb/1qv/25D/68H/69b//7b//9b//9v//+v///9vHVHrAAAACXBIWXMAAAsSAAALEgHS3X78AAAYBUlEQVR4nO2dj18bx5nGhWuOuDlsNwWb4lxyxHFMljjBTdKKux7EuWskmvYC7fkUY4qgyOz//x90fq5WjyRGoFlJO+/zfBytpJ19dvb5amZH2Lxp5JRINebdAWo+InihInihInihInihInihInihInihInihInihInihInihInihInihInihInihInihqhv4v827A9MoYuf/Btsba6HBHzes1vwb756sFjsvH2yVNvB05OugLu+vhRsFdHZnf4xVufNDu9bMY6MxtslIq2ssQ1po8Ern75XhjQAfU/MCr4iv6cdlddhEJOWA14Ph7mv9uJyfr5hJoD/iLx98vNJY2jJPdd4q+3cfftRY+nfVwh5oJo8l+0EpWrum5+99pFzPtPPl/V+vNDQ4d5RxMUepc2oXf2p3qHf1J7m831j6yIO3VnvL6sXxsruEZd/UdMK21H37xa/W3KWeaZ/igu3he4OHLW1ZK2fpzlA4Dl/xSNUDvB4M+Z4mv2pT37uzXwJ/Xyd893UZ/BMT05YZEsd3X2tKxVh0rT34leX8TH+e3rNGx/poe5RxscesDZzaHepc+81Xrbs/y7FtYidyMzz9hfjdxv2v+6aFYX5+b9+39f12J9cvfd/LI96dAfteuuKRqgd4E4cPQOtsEPyaf6cPftXsOrNjYK0UQdG6AG+HsPrPvKUe/FHl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" alt="plot of chunk unnamed-chunk-13"/> </p>

<p>Or, more detailed, table with top 20 event types:</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_INJURIES)), 1:20), EVTYPE, TOTAL_INJURIES)
</code></pre>

<pre><code>## Source: local data frame [20 x 2]
## 
##                EVTYPE TOTAL_INJURIES
## 1             TORNADO          91346
## 2           TSTM WIND           6957
## 3               FLOOD           6789
## 4      EXCESSIVE HEAT           6525
## 5           LIGHTNING           5230
## 6                HEAT           2100
## 7           ICE STORM           1975
## 8         FLASH FLOOD           1777
## 9   THUNDERSTORM WIND           1488
## 10               HAIL           1361
## 11       WINTER STORM           1321
## 12  HURRICANE/TYPHOON           1275
## 13          HIGH WIND           1137
## 14         HEAVY SNOW           1021
## 15           WILDFIRE            911
## 16 THUNDERSTORM WINDS            908
## 17           BLIZZARD            805
## 18                FOG            734
## 19   WILD/FOREST FIRE            545
## 20         DUST STORM            440
</code></pre>

<p>Finally, let&#39;s look at top 20 event types, calculated by our heuristic algo (fatality 5 times worse as injury):</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_POPULATION_DAMAGE)), 1:20), EVTYPE, TOTAL_FATALITIES, TOTAL_INJURIES)
</code></pre>

<pre><code>## Source: local data frame [20 x 3]
## 
##               EVTYPE TOTAL_FATALITIES TOTAL_INJURIES
## 1            TORNADO             5633          91346
## 2     EXCESSIVE HEAT             1903           6525
## 3          TSTM WIND              504           6957
## 4          LIGHTNING              816           5230
## 5              FLOOD              470           6789
## 6               HEAT              937           2100
## 7        FLASH FLOOD              978           1777
## 8          ICE STORM               89           1975
## 9          HIGH WIND              248           1137
## 10      WINTER STORM              206           1321
## 11 THUNDERSTORM WIND              133           1488
## 12       RIP CURRENT              368            232
## 13        HEAVY SNOW              127           1021
## 14 HURRICANE/TYPHOON               64           1275
## 15              HAIL               15           1361
## 16      RIP CURRENTS              204            297
## 17          BLIZZARD              101            805
## 18         AVALANCHE              224            170
## 19          WILDFIRE               75            911
## 20         HEAT WAVE              172            379
</code></pre>

<p>As we can see, tornado is totally causes max fatalities and injuries with a huge difference with other types. Other the mosts dangerous for population event types are excessive heat, thunderstorm wind and lighting. Interesting points are:</p>

<ul>
<li>hit and flash flood cause lots of fatalities but small (comparing) number of injuries;</li>
<li>flood, ice storm, hurricane, hale cause lots of injuries but small (comparing) number of fatalities.</li>
</ul>

<h3>Economical damage</h3>

<p>Let&#39;s first look at top 10 event types that causes economical damage:</p>

<pre><code class="r">ggplot(
    slice(arrange(data_per_type, desc(TOTAL_ECONOMICAL_DAMAGE)), 1:10), 
    aes(x = reorder(EVTYPE, TOTAL_ECONOMICAL_DAMAGE), y = TOTAL_ECONOMICAL_DAMAGE)
) + 
geom_bar(stat=&quot;identity&quot;) + 
coord_flip() + 
labs(x = &#39;Event type&#39;) +
labs(y = &#39;Economical damage in $&#39;) +
labs(title = &#39;Total economical damage caused by top 10 event types&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABL1BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOgBmOjpmZmZmkJBmtttmtv9/f39/f5V/f6t/lcF/q8F/q9aQOgCQOjqQZgCQZpCQkGaQtpCQ29uQ2/+Vf3+Vf5WVf6uVlZWVlauVlcGVq9aVwdaVweurf3+rf5Wrf6urlZWrlaurlcGrq6urwcGrwdarweur1uur1v+2ZgC225C2/7a2/9u2///BlX/BlZXBlavBq8HBwavBwdbB6+vB6//Wq3/Wq5XWwZXW6//W/+vW///bkDrbkJDb29vb/7bb/9vb///l5eXrwZXrwavr1qvr68Hr/9br/+vr///y8vL/tmb/1qv/25D/68H/69b//7b//9b//9v//+v///9E8es2AAAACXBIWXMAAAsSAAALEgHS3X78AAAZw0lEQVR4nO2dDXsbx3WFIUVlKImUk6aEpVKunVC2QxayEzlxyKaUrDaAYpOJq8K1zQCg+bH//zd0Phe7FzvQJXh3MMCc81hcYDG75+K8mNklJV53CihLdZZdALQcAXymAvhMBfCZCuAzFcBnKoDPVACfqQA+UwF8pgL4TAXwmQrgMxXAZyqAz1QAn6kAPlMlD/7vyy6gNQm+s7+TLUNpgT/tWO34HVdPt8oXLx7tLXbW2QOre0Z3jxc7LUfu5BfbO/SV6jubeWnHfO10gkMaTzXnlLNKC7zS5H6Vkgj4WSUNXhHf0V831GEskmsFXn/e773VXzeKyaZZBDwt+1Khd+uNe3rx6NebnTt75fPJ/Y/UsSN9vD7QDSanutju3PlIsXG7K8f4XeUQ72pqrJ9MU9WE1XpVKaA80vj8arOjHh6pExenG+5NbNRq95+/087PfrHjchg5RzfOHH60Qd6yPZU7pXMoz+iLcbVNlSh4/XkvjjT5LRvs0d1jR8t8rk/vvVW79UM/8mJbB6uPsM8nmxvFSH9q7u+pA93ghlPp4/zu6jF+pJp0k827x95VH0ZP5sBr9qPpSH9ye4T+XNghdiEvZmo/deT/dmxGGOaTB8fVt6wPd+Y2Af+WpzPeOfgzVo+sL22Jgjfv2L9HrVFJa2Q/yDvuffiRPn7/fLJp56J+6dFe9U2TU/mX9LHTY/wuk79D5pnRk1XA0/qqS70rsgKzVvv0cmBszIfMLX/+lHrIaFqLN66Cdw7+jCSsihIFP7KL+JZ9T2rR7JS03A3glpt+fmQZv3uuz6OPsOBP/SpdP1U5q+zuyjF+l1mX1Wm9a3lY5WRl/ubaUKvPUTZ++r2oldic0U1PX7t/uXAvEfCluTpcn8E9bQLvHPwZ/VBXW0UrAF7Fu1WZpj72RcA3ncrMD7u7eozbVYL3sIvKiu9O5q/xKnV1Ia3VR8FPHvynXTXeCb661Jfmo7t/Vmb+aSN461CCn5Z9VL/IJwq+utSbCMj6PN0Gl/oaeL8MN5zKf1jq4P2u2lLvRE82Ba+zrtVHlnr1+q8sy3cu9eY1d3NXmqubxAfTi3UjeOtQW+rL01Zv+hMFX725G5nb7jt75R2ZSmN0x9x+nW5UbpB8Cu7mrgbeDZ451Ya57/K7q+DdLn+L5l31YeRk+ixXT91Z7u/5kf7k9gh7G6ZXbbvSz97cHZWT04Cvfjs3NTeHVxOYAW+HTO/77FBXWyXnRMFXvg1RlzV1Jf2z4Vf4l3QIk9o3LOW8K7+dq4L3g2dPZb7jcrur13i3y35Tps7nXU2NtZOZIb9+YM5ivwMvv60rv53T310ZsPr+0eq08u3c9j9Pv1ds+gFOaW4Pd08r30dulKe0Q8oz+iOPOuQinxz4FDWqXOBvKXfVrqvh5zu3dHj3GQF+vvQCe6OfiL1Dp02nEgV/usU6I8C/Q6cd7o/MGZpsNq4dguCdwwqC/1+imR0M/WOBY1L2ETEiOQP8CvgAfMScUvIB+Ig5peQD8BFzSskH4CPmlJJPluB/Di0mgM9UAJ+pAD5TAXymAvhMBfCZCuAzFcBnKoDPVACfqQA+UwF8pgL4TAXwmQrgMxXAZyqAz1RpgD9/1u12e+f7Z/rJ9ctu9/FJuTWvHQK8sBIBf2C+GvCXzxXl8eMTv9WvXX7WB3hZpQd+3NOPhz2/Na8N9RM187v0yGXnt7J6B5GIS72a2wb80Czr457fGvD2U1BgxotpVWa8v8gDvJDSA994jf/8BOBllRR4ff++i7v6KEoDPF8ALySAz1QAn6kAPlMBfKYC+EwF8JkK4DMVwGcqgM9UAJ+pAD5TAXymAvhMtergU+4/hz53gpIICuAbjEjOAL8CPgAfMaeUfLIEv+x7pGbJ8WAJ4FORHA+WAD4VyfFgCeBTkRwPlgA+FcnxYAngU5EcD5YAPhXJ8WAJ4FORHA+WAD4VyfFgCeBTkRwPlgA+FcnxYAngU5EcD5YAPhXJ8WAJ4FORHA+WAD4VyfFgCeBTkRwPlgA+FcnxYCkmeNO1ZnDoN7Z7jdvoVkX6oW5bdf7JifviRnUPi+vX/9c1jwZ6xKBn9j85c+ea6YFjDwb4sJYIXm2uX/XdRoHXrSivXypagy8U3PNPD8wo27K0OP/S9bFSY4vxru125fqaDQ5nul7ZgwE+rITAD11DwssXP+jpfzA8rID/ru8bmJ3vm5dr4Gf73JmDi1XqbBlKbXUUBm+X7dBS7xsSqq367/xA7XKjHp9cvz4rO9eN3++7c6ml3p5ytrOlOdj50g/ushE3S24isrSsGf9GT/XLF2eF2yhQZrr+9PXlc3/1Hu+WM16v9B68Hl74/aEZbw4G+LCWAF7zU3/0M32xtpvyGt9TT/zHY9D14PVKPwd8U2fLQRfg52gJ4IuxuU+3z9xVulfe1eubNwXvyfcHplOpXcv//fXZXPAzd/UHrs0pwIeE7+NTkRwPlgA+FcnxYAngU5EcD5YAPhXJ8WAJ4FORHA+WAD4VyfFgCeBTkRwPlgA+FcnxYAngU5EcD5YAPhXJ8WAJ4FORHA+WAD4VyfFgCeBTkRwPlgA+FcnxYClH8Cm3IQN4QUkEBfANRiRngF8BH4CPmFNKPlmCX+rdWwQe0YxIzgAP8GmI1g/wQkYkZ4AH+DRE6wd4ISOSM8ADfBqi9QO8kBHJGeABPg3R+gFeyIjkDPAAn4Zo/QAvZERyBniAT0O0foAXMiI5AzzApyFaP8ALGZGcAR7g0xCtH+CFjEjOLYEfd12PS9fmxnVL8z0sbTvMZ2ZI2RIH4Fs1igPeNT+qNrbS/RF9D0vbDlM3Pfqs78cAfLtGUcFXWtnZxpi2h6Vvh1lU290VSXW2bCuWZNQu+LJ5pVvqXQ9L3w6zqDa4dMfRD+6SwEebiNGMooKvzHjXGFP3sJy2w9QfjcqMB/gWjaKCr17jXWPMQfew0g5T98jENT6KUVTw1eaVrjHm5fM/+XaYuKvnapXALypaP8ALGZGcAR7g0xCtH+CFjEjOAA/waYjWD/BCRiRngAf4NETrB3ghI5IzwAN8GqL1A7yQEckZ4AE+DdH6AV7IiOQM8ACfhmj9AC9kRHIGeIBPQxJBod1ZgxHJGeBXwAfgI+aUkg/AR8wpJZ8swce6fwP4JYvWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiRngA/kxBHAC4rWD/BCRiTn24EfmvZFgf6lz3QHs/H7/elA2wPp0A0w4/XeZ/ZwgG/VSBL8+f6ZblgZ6F/629+rnW8+7U8HevB2wPXLQ9PTVL84Fa0f4IWMRMF/3LcPGvuX7v9VzeY/mt5mbmAdvGl35z4VVnFbmt7mna++brfU6x6VGl9j/9L97w+K7/5iwLuB9aVefVD0Ym+fLqHB4fwJwlG2M95o0Av0L93/8atvXv/4qj8daMC/6bsBdsYPD7HURzGSBD9+cmbbkDf2L90/G/7hy2vXxtIM1MPUHzfg+mVP3+ABfBwjSfDmZl3P88b+pftn6tJuwfuB48rNfU/3tZ3e1cdvYjw/J47yBd+CaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygaP0AL2REcgb4QE4cAbygJIJCn7sGI5IzwK+AD8BHzCklH4CPmFNKPlmCX+RODeAbjEjOAB/IiSOAFxStH+CFjEjOAB/IiSOAFxStH+CFjEjOAB/IiSOAFxStH+CFjEjOAB/IiSOAFxStH+CFjEjOAB/IiSOAFxStH+CFjEjOAB/IiSOAFxStH+CFjEjOBPzV0869bx/tRcM8K1o/wAsZkZzr4K+ebk0evh3dexsPNBWtH+CFjEjOdfAX7x0r8OprPNBUtH6AFzIiOTfN+FPMeJ7WB7y+xnc6LXN3Tc/Ug09OTPucWvcjWj/ACxnNBx9DJfjBFz2Aj2ZEKCwR/OWLH1z7Mw/+Fp0tI7+H1VfTUr/RrqVvWjw0/2HGRzKaC17d3Kmvp+2SdzNedzntPjkD+EhGc8Hbb+Ra/nbOgTcdTU23S4CPYTQXvJ3sUWb8n1yvU3Wd9/3rAb5No7ngL7Y7VneX9iMcWj/ACxmRnPGXNIGcOAJ4QdH6AV7IiORMl/qWv5V7t2j9AC9kRHKmM37U6dxZ5t/KAnxbRiTnhqVe/xBnJwrkJtH6AV7IiORMwU829Yxf4l/M0voBXsiI5Eyv8cv8G1kjWj/ACxmRnJfwk7v5ovUDvJARybkKvvzxDf4hBk/rAn7Jc92K1g/wQkYkZ/wAJ5ATRwAvKFo/wAsZkZwBPpATR+sDPsG7+pSBrAv4JO/qUwayLuCTvKtPGcj6gE9AEkEBfIMRyZmAHy35398sdnPXRk4crQ/4i+3l/bWcE60f4IWMSM7JX+MBXsiI5EyW+qOtaIQDovUDvJARybnxX9niGs/T+oBPQLR+gBcyIjkDfCAnjtYI/Gr2wGkjJ47WB/yK9sBpIyeO1gf8ivbAaSMnjtYH/Ir2wGkjJ47WB3yUHjjzResHeCEjkjPu6gM5cQTwgqL1A7yQEcl5LX6hoo2cOFof8OZXqNpufjRftH6AFzIiOTct9SP8rJ6ndQK/wIw3LWx6voORaVdZDE1Ds7KVYX3M9ctu9/FJuTWvHQJ8y0ZzwS90jTd4Cw/etKvUT65f9SvgK2Mun6s948cnfqtfu/ysD/DtGs0Fv5Bq4G27yvOP++UrM+DHPf142PNb89pQP1m0s+Xt30N+qv3z6veOi8nDtzf9dzh6qX7sm9XZdpWF7l64W/awrI8ZmmV93PNbA95+CgrM+NaMWgBfW8ZNu0qzf9C7yYz3F3laP8ALGbUL3rWrHGv2g8MbXOM/PwH4do1aA6+X9X917SrP9F19b/Yab1tY4q5+GUby4GVF6wd4ISOSc+PvzuEHODytC/gkROsHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFJREUwDcYkZwBfgV8AD5iTin5AHzEnFLyAfiIOaXkkyX4G97Qi+XEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcALitYP8EJGJGeAD+TEEcDPyDU0ct2OyjZHrhmSfjrteDrudivdj2j9AC9kFAm8bVOqN9ev+tXGZor09cvD8lXTFGva7AzgWzOKB971LlTga60M1RTfrQyqgl+gpWk75WegNsGPe26przUvVeB7ZrE/LDueYsZHMIoIfqhbW16+OCtqM/5N38744SGW+phG8cArnHqjMJdNTBVg9ef6ZU/f7wF8VKNI4J9V7tt7ZRPTsbt9H9T/PwYAH8EoDvjFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFResHeCEjkjPAB3LiCOAFJREUwDcYkZwBfgV8AD5iTin5AHzEnFLyyRL8Avd2AN9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIG+EBOHAG8oGj9AC9kRHIWBu/a2viN7XbmNrrTjX6oW2Cdf3LivgymXc8Avk2jqOBtf0Pf3/Lzk8vP+oXpazn4QuE///TAjNo/q5yB1g/wQkZLBT/s2WGXL37Q0/9geFgDf/POlrLV5yRp8HbZDi31Q7egq+1QtztTu9yox77hGf3gYsYLGbUMvjLj3/RdY0u3UZRNi8ufvr58rlA/OVP7x7tY6iMZRQHvWli6xpa+v6W/xvdMT1P78Rh0AT6OURTwroWla2zpNuVdvbreqx3jJ9/rvqfP3V19D+DbNWoX/O1F6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AUlERTANxiRnAF+BXwAPmJOKfkAfMScUvLJEvwN7ulEc+II4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuII4AVF6wd4ISOSM8AHcuIoe/BlP7NvdPNC3d3GdT2z+/2InmtzdP3StjdzW/Oab2wJ8G0ZtQK+7GDo+1lZwm6/e6S+mt2XzxXl8eMTv9Wv6XZYAN+qUbvgNWaFdy540+yuGPb81rxmel6yO1tKFJ25ZJf6Ew1Q/eeaVdaXevXcgLftLcc9vzXgxzdqdxZhgnCEGV+2rlST+sevTorpjNf7C86Mv1H36gg5cQTwZevKonjzX7tFBXwx3qXgG6/xn9+ol22EnDgC+GnrymL8ft/3MvYtLafg7dKPu/plGLUBXlK0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlC0foAXMiI5A3wgJ44AXlASQQF8gxHJGeBXwAfgI+aUkg/AR8wpJR+Aj5hTSj5Zgr/xLb1QThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwBvKBo/QAvZERyBvhAThwB/FSm5dmzbtf1urNNjYbmwbhrd1R7Hu2qjW6OZFomAXybRu2D1+1Jr1/6tqaF7XJmGlyatljVLmdq7/lvf6+bpH0K8C0btQ9+2CtxO/Af98sXp/0NPfj9vx4W5380jU95LU2FK85UbYC3PetcW1Oz87ntbGrAl51M3VK///1B8d1fXmHGt2zUPngzpX/6ejrjjXSfQzrjdb9T3QP1m9c/AnzbRu2Dt9f43hT8+MmZ7mXecI0f6xl/NvzDl9cA37ZR++Brd/V2ersHtmOtv6u3/U51k/OP+wDfulHL4G8tWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oWj/ACxmRnAE+kBNHAC8oiaAAvsGI5AzwK+AD8BFzSskH4CPmlJIPwEfMKSUfgI+YU0o+WYCnmvkNC/iIGAH8mvoAfKY+AJ+pz8qDh9oRwGcqgM9UAJ+pAD5TpQV+0HW9cMoH5KXZ/Qv6uPM0nM/8Sq+Qj/v94LBPOUDOaMap2Sgp8OMnZ+Z36acP7O6e31Pfv7DKX8qe9SnG+le4hXzsyeb4lAOkjKa/bv4uo6TAD3vug+keDOyv1ev67Z5ywO10+btnpjVLg8/1f19/dVII+diTzfEpB0gZuXfGMEoL/GFh67MPxrv60dD0V7B7ygG301h9+k0rnlmfwhgI+RT+LCGfQsimPI99ZxyjtMDXZ7yvXHzGa5llcNbHgZfyqc34WR9x8FrjHscoKfDkGm/rbuEabz5Jh40+NiGpa3w5EQM+8jPevDOOUVLg7c2v7oXl7+Fda8xC/q6+F/CxCUnd1euTzfMRBW+N9FRnGKUFHoomgM9UAJ+pAD5TAXymyhb8ZLOjdGePOfrBceD51dOdG5jWTjNSBdzgYFnlC56gXPToG4Gvn+P+bz789r3bVHEbAfzFtp736uvd42Ly8N/MJLTPrj74qNPZUvNyy4y2A/VKseOPVrt+9osdt68y3O0xr//Sn9yaegv15OH/fPh2WW8f4PWMHd17e7Slv042zaawz66ebiiCGwbXg2M78NtHe+65PliP6+xc2H2V4W6PeV19WNTmdMOZegv9qfgXgI8ve41XrA3CC7XkKlr6ieZmn119sFfoP/aF6equXp4e5ZZ69bAy3O0xr3+wp3dcmDXdncaf6sisDstRvuBd+JOHb90zhchRcc8I+Id2eipadx148/Vox+2rgbej1CEa/La/jSTgrz78dntZd3cAf7MZf7G9M13q3Yx3+yrD3R4/48s7uBr40cbVh/oSsxxlD14v1eqxu8Y7Ku4aXwNvB/6HHnF/r3aNn9h99eF6T+Uaby/rNfAXj9Rd/SPm95Piyhe8ucar++vaXb2j4u/qayTtwNOOvpF34K+emrt6u6+61Ns9+pB/+mDPHVnQpd7d+i9H2YKPpXk/L7jCXf16Si0I7J8NxhbAZyqAz1QAn6kAPlMBfKYC+EwF8JkK4DPV/wOMit+BPeQxEwAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>Or, more detailed, table with top 20 event types:</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_ECONOMICAL_DAMAGE)), 1:20), EVTYPE, TOTAL_PROPERTY_DAMAGE, TOTAL_CROP_DAMAGE)
</code></pre>

<pre><code>## Source: local data frame [20 x 3]
## 
##                       EVTYPE TOTAL_PROPERTY_DAMAGE TOTAL_CROP_DAMAGE
## 1                      FLOOD          144657709807        5661968450
## 2          HURRICANE/TYPHOON           69305840000        2607872800
## 3                    TORNADO           56925660790         414953270
## 4                STORM SURGE           43323536000              5000
## 5                       HAIL           15727367053        3025537890
## 6                FLASH FLOOD           16140812067        1421317100
## 7                    DROUGHT            1046106000       13972566000
## 8                  HURRICANE           11868319010        2741910000
## 9                RIVER FLOOD            5118945500        5029459000
## 10                 ICE STORM            3944927860        5022113500
## 11            TROPICAL STORM            7703890550         678346000
## 12              WINTER STORM            6688497251          26944000
## 13                 HIGH WIND            5270046295         638571300
## 14                  WILDFIRE            4765114000         295472800
## 15                 TSTM WIND            4484958495         554007350
## 16          STORM SURGE/TIDE            4641188000            850000
## 17         THUNDERSTORM WIND            3483121284         414843050
## 18            HURRICANE OPAL            3152846020           9000010
## 19          WILD/FOREST FIRE            3001829500         106796830
## 20 HEAVY RAIN/SEVERE WEATHER            2500000000                 0
</code></pre>

<p>Let&#39;s additionally examine top 20 property damage causes:</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_PROPERTY_DAMAGE)), 1:20), EVTYPE, TOTAL_PROPERTY_DAMAGE)
</code></pre>

<pre><code>## Source: local data frame [20 x 2]
## 
##                       EVTYPE TOTAL_PROPERTY_DAMAGE
## 1                      FLOOD          144657709807
## 2          HURRICANE/TYPHOON           69305840000
## 3                    TORNADO           56925660790
## 4                STORM SURGE           43323536000
## 5                FLASH FLOOD           16140812067
## 6                       HAIL           15727367053
## 7                  HURRICANE           11868319010
## 8             TROPICAL STORM            7703890550
## 9               WINTER STORM            6688497251
## 10                 HIGH WIND            5270046295
## 11               RIVER FLOOD            5118945500
## 12                  WILDFIRE            4765114000
## 13          STORM SURGE/TIDE            4641188000
## 14                 TSTM WIND            4484958495
## 15                 ICE STORM            3944927860
## 16         THUNDERSTORM WIND            3483121284
## 17            HURRICANE OPAL            3152846020
## 18          WILD/FOREST FIRE            3001829500
## 19 HEAVY RAIN/SEVERE WEATHER            2500000000
## 20        THUNDERSTORM WINDS            1733459026
</code></pre>

<p>And top 20 crop damage causes:</p>

<pre><code class="r">select(slice(arrange(data_per_type, desc(TOTAL_CROP_DAMAGE)), 1:20), EVTYPE, TOTAL_CROP_DAMAGE)
</code></pre>

<pre><code>## Source: local data frame [20 x 2]
## 
##               EVTYPE TOTAL_CROP_DAMAGE
## 1            DROUGHT       13972566000
## 2              FLOOD        5661968450
## 3        RIVER FLOOD        5029459000
## 4          ICE STORM        5022113500
## 5               HAIL        3025537890
## 6          HURRICANE        2741910000
## 7  HURRICANE/TYPHOON        2607872800
## 8        FLASH FLOOD        1421317100
## 9       EXTREME COLD        1312973000
## 10      FROST/FREEZE        1094186000
## 11        HEAVY RAIN         733399800
## 12    TROPICAL STORM         678346000
## 13         HIGH WIND         638571300
## 14         TSTM WIND         554007350
## 15    EXCESSIVE HEAT         492402000
## 16            FREEZE         456725000
## 17           TORNADO         414953270
## 18 THUNDERSTORM WIND         414843050
## 19              HEAT         401461500
## 20   DAMAGING FREEZE         296230000
</code></pre>

<p>As we can see, flood is totally causes max economical damage with a huge difference with other types. Other the mosts dangerous for economic event types are hurricane, tornado and storm surge. Interesting points are:</p>

<ul>
<li>storm surge makes a big property damage and almost no crop damage;</li>
<li>drought makes a big crop damage and small (comparing) property damage.</li>
</ul>

</body>

</html>
